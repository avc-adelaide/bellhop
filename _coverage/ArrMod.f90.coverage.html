<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coverage Report: ArrMod.f90</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .metric {
            background-color: #ecf0f1;
            padding: 10px;
            border-radius: 3px;
            text-align: center;
            min-width: 120px;
        }
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        .code-container {
            background-color: white;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            overflow: auto;
        }
        .code-line {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
        }
        .line-number {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 60px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #6c757d;
        }
        .execution-count {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 80px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #495057;
        }
        .source-code {
            padding: 2px 8px;
            flex: 1;
            white-space: pre;
        }
        .executed { background-color: #d4edda; }
        .not-executed { background-color: #f8d7da; }
        .non-executable { background-color: #f8f9fa; }
        .footer {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-size: 0.9em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Coverage Report: ArrMod.f90</h1>
        <p>Generated from GCOV analysis of Fortran source code</p>
    </div>

    <div class="summary">
        <div class="metric">
            <div class="metric-value">27.1%</div>
            <div>Lines Executed</div>
            <div>155 total lines</div>
        </div>
        <div class="metric">
            <div class="metric-value">52.0%</div>
            <div>Branches Executed</div>
            <div>404 total branches</div>
        </div>
        <div class="metric">
            <div class="metric-value">100.0%</div>
            <div>Calls Executed</div>
            <div>16 total calls</div>
        </div>
    </div>

    <div class="code-container">
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Source:ArrMod.f90</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Graph:ArrMod.gcno</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Data:ArrMod.gcda</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Runs:57</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Acoustic arrivals module for computing and storing arrival information</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">2</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">3</div>
            <div class="execution-count">-</div>
            <div class="source-code">MODULE ArrMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">4</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Management of acoustic arrival data including storage, sorting, and output formatting</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">5</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">6</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE MathConstants</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">7</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE BellhopMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">8</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">9</div>
            <div class="execution-count">-</div>
            <div class="source-code">  IMPLICIT NONE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">10</div>
            <div class="execution-count">-</div>
            <div class="source-code">  PUBLIC</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">11</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">12</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Variables for arrival information</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">13</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL,      PARAMETER :: PhaseTol = 0.05  ! arrivals with essentially the same phase are grouped into one</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">14</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER               :: MaxNArr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">15</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER, ALLOCATABLE  :: NArr( :, : ), NArr3D( :, :, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">16</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL         (KIND=4) :: factor = 1.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">17</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">18</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE Arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">19</div>
            <div class="execution-count">-</div>
            <div class="source-code">     INTEGER :: NTopBnc, NBotBnc</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">20</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL    :: SrcDeclAngle, SrcAzimAngle, RcvrDeclAngle, RcvrAzimAngle, A, Phase</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">21</div>
            <div class="execution-count">-</div>
            <div class="source-code">     COMPLEX :: delay</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">22</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE Arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">23</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">24</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE(Arrival), ALLOCATABLE :: Arr( :, :, : ), Arr3D( :, :, :, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">25</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">26</div>
            <div class="execution-count">-</div>
            <div class="source-code">CONTAINS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">27</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">28</div>
            <div class="execution-count">1234</div>
            <div class="source-code">  SUBROUTINE AddArr( omega, id, ir, Amp, Phase, delay, SrcDeclAngle, RcvrDeclAngle, NumTopBnc, NumBotBnc )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">29</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Adds an arrival to the arrival data structure</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">30</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">31</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Adds the amplitude and delay for an ARRival into a matrix of same.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">32</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Extra logic included to keep only the strongest arrivals.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">33</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">34</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,              INTENT( IN ) :: NumTopBnc, NumBotBnc, id, ir</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">35</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL    ( KIND = 8 ), INTENT( IN ) :: omega, Amp, Phase, SrcDeclAngle, RcvrDeclAngle</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">36</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX ( KIND = 8 ), INTENT( IN ) :: delay</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">37</div>
            <div class="execution-count">-</div>
            <div class="source-code">    LOGICAL              :: NewRay</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">38</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER              :: iArr( 1 ), Nt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">39</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL                 :: AmpTot, w1, w2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">40</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">41</div>
            <div class="execution-count">1234*</div>
            <div class="source-code">    Nt     = NArr( id, ir )    ! # of arrivals</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">42</div>
            <div class="execution-count">1234</div>
            <div class="source-code">    NewRay = .TRUE.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">43</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">44</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Is this the second step of a pair (on the same ray)?</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">45</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! If so, we want to combine the arrivals to conserve space.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">46</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! (test this by seeing if the arrival time is close to the previous one)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">47</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! (also need that the phase is about the same to make sure surface and direct paths are not joined)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">48</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! LP: BUG: This only checks the last arrival, whereas the first step of the</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">49</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! pair could have been placed in previous slots. See readme.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">50</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">51</div>
            <div class="execution-count">1234</div>
            <div class="source-code">    IF ( Nt &gt;= 1 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">52</div>
            <div class="execution-count">2440*</div>
            <div class="source-code">       IF ( omega * ABS( delay - Arr( id, ir, Nt )%delay ) &lt; PhaseTol .AND. &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">53</div>
            <div class="execution-count">1805*</div>
            <div class="source-code">           ABS( Arr( id, ir, Nt )%phase - Phase )       &lt; PhaseTol ) NewRay = .FALSE.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">54</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">55</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">56</div>
            <div class="execution-count">1234</div>
            <div class="source-code">    IF ( NewRay ) THEN</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">57</div>
            <div class="execution-count">649</div>
            <div class="source-code">       IF ( Nt &gt;= MaxNArr ) THEN       ! space not available to add an arrival?</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">58</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          iArr = MINLOC( Arr( id, ir, : )%A )                       ! replace weakest arrival</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">59</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          IF ( Amp &gt; Arr( id, ir, iArr( 1 ) )%A ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">60</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%A             = SNGL( Amp )       ! amplitude</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">61</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%Phase         = SNGL( Phase )     ! phase</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">62</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%delay         = CMPLX( delay )    ! delay time</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">63</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%SrcDeclAngle  = SNGL( SrcDeclAngle )  ! launch angle from source</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">64</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%RcvrDeclAngle = SNGL( RcvrDeclAngle ) ! angle ray reaches receiver</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">65</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%NTopBnc       = NumTopBnc         ! Number of top     bounces</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">66</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr( id, ir, iArr( 1 ) )%NBotBnc       = NumBotBnc         !   &quot;       bottom</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">67</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">68</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">69</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          NArr( id, ir         )               = Nt + 1              ! # of arrivals</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">70</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%A             = SNGL( Amp )         ! amplitude</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">71</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%Phase         = SNGL( Phase )       ! phase</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">72</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%delay         = CMPLX( delay )      ! delay time</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">73</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%SrcDeclAngle  = SNGL( SrcDeclAngle )    ! launch angle from source</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">74</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%RcvrDeclAngle = SNGL( RcvrDeclAngle )   ! angle ray reaches receiver</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">75</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%NTopBnc       = NumTopBnc           ! Number of top     bounces</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">76</div>
            <div class="execution-count">649*</div>
            <div class="source-code">          Arr(  id, ir, Nt + 1 )%NBotBnc       = NumBotBnc           !   &quot;       bottom</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">77</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">78</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE      ! not a new ray</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">79</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !PhaseArr(   id, ir, Nt ) = PhaseArr( id, ir, Nt )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">80</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">81</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! calculate weightings of old ray information vs. new, based on amplitude of the arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">82</div>
            <div class="execution-count">585*</div>
            <div class="source-code">       AmpTot = Arr( id, ir, Nt )%A + SNGL( Amp )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">83</div>
            <div class="execution-count">585*</div>
            <div class="source-code">       w1     = Arr( id, ir, Nt )%A / AmpTot</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">84</div>
            <div class="execution-count">585</div>
            <div class="source-code">       w2     = REAL( Amp ) / AmpTot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">85</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">86</div>
            <div class="execution-count">585*</div>
            <div class="source-code">       Arr( id, ir, Nt )%delay         = w1 * Arr( id, ir, Nt )%delay         + w2 * CMPLX( delay ) ! weighted sum</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">87</div>
            <div class="execution-count">585*</div>
            <div class="source-code">       Arr( id, ir, Nt )%A             = AmpTot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">88</div>
            <div class="execution-count">585*</div>
            <div class="source-code">       Arr( id, ir, Nt )%SrcDeclAngle  = w1 * Arr( id, ir, Nt )%SrcDeclAngle  + w2 * SNGL( SrcDeclAngle  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">89</div>
            <div class="execution-count">585*</div>
            <div class="source-code">       Arr( id, ir, Nt )%RcvrDeclAngle = w1 * Arr( id, ir, Nt )%RcvrDeclAngle + w2 * SNGL( RcvrDeclAngle )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">90</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">91</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">92</div>
            <div class="execution-count">1234</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">93</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE AddArr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">94</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">95</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">96</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">97</div>
            <div class="execution-count">12*</div>
            <div class="source-code">  SUBROUTINE WriteArrivalsASCII( r, Nrd, Nr, SourceType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">98</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Writes arrival data in ASCII format</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">99</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">100</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Writes the arrival data (Amplitude, delay for each eigenray)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">101</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! ASCII output file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">102</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">103</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,           INTENT( IN ) :: Nrd, Nr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">104</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL,              INTENT( IN ) :: r( Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">105</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=1), INTENT( IN ) :: SourceType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">106</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER           :: ir, id, iArr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">107</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">108</div>
            <div class="execution-count">46*</div>
            <div class="source-code">    WRITE( ARRFile, * ) MAXVAL( NArr( 1 : Nrd, 1 : Nr ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">109</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">110</div>
            <div class="execution-count">24*</div>
            <div class="source-code">    DO id = 1, Nrd</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">111</div>
            <div class="execution-count">41*</div>
            <div class="source-code">       DO ir = 1, Nr</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">112</div>
            <div class="execution-count">17</div>
            <div class="source-code">          IF ( SourceType == &#x27;X&#x27; ) THEN   ! line source</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">113</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             factor =  4.0 * SQRT( pi )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">114</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ELSE                            ! point source</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">115</div>
            <div class="execution-count">17*</div>
            <div class="source-code">             IF ( r ( ir ) == 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">116</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                factor = 1e5                   ! avoid /0 at origin</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">117</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">118</div>
            <div class="execution-count">17*</div>
            <div class="source-code">                factor = 1. / SQRT( ABS( r( ir ) ) )  ! cyl. spreading [CF] ABS() used to eliminate NaN for -ve range values</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">119</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">120</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">121</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">122</div>
            <div class="execution-count">17*</div>
            <div class="source-code">          WRITE( ARRFile, * ) NArr( id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">123</div>
            <div class="execution-count">678*</div>
            <div class="source-code">          DO iArr = 1, NArr( id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">124</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! You can compress the output file a lot by putting in an explicit format statement here ...</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">125</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! However, you&#x27;ll need to make sure you keep adequate precision</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">126</div>
            <div class="execution-count">-</div>
            <div class="source-code">             WRITE( ARRFile, * ) &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">127</div>
            <div class="execution-count">649*</div>
            <div class="source-code">                     factor * Arr( id, ir, iArr )%A,             &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">128</div>
            <div class="execution-count">649*</div>
            <div class="source-code">             SNGL( RadDeg ) * Arr( id, ir, iArr )%Phase,         &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">129</div>
            <div class="execution-count">649*</div>
            <div class="source-code">                        REAL( Arr( id, ir, iArr )%delay ),       &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">130</div>
            <div class="execution-count">649*</div>
            <div class="source-code">                       AIMAG( Arr( id, ir, iArr )%delay ),       &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">131</div>
            <div class="execution-count">649*</div>
            <div class="source-code">                              Arr( id, ir, iArr )%SrcDeclAngle,  &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">132</div>
            <div class="execution-count">649*</div>
            <div class="source-code">                              Arr( id, ir, iArr )%RcvrDeclAngle, &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">133</div>
            <div class="execution-count">649*</div>
            <div class="source-code">                              Arr( id, ir, iArr )%NTopBnc,       &amp;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">134</div>
            <div class="execution-count">1315</div>
            <div class="source-code">                              Arr( id, ir, iArr )%NBotBnc</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">135</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO  ! next arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">136</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO  ! next receiver depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">137</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO  ! next receiver range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">138</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">139</div>
            <div class="execution-count">12</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">140</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE WriteArrivalsASCII</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">141</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">142</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">143</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">144</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">145</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE WriteArrivalsBinary( r, Nrd, Nr, SourceType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">146</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Writes arrival data in binary format</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">147</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">148</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Writes the arrival data (amplitude, delay for each eigenray)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">149</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Binary output file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">150</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">151</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,           INTENT( IN ) :: Nrd, Nr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">152</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL,              INTENT( IN ) :: r( Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">153</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=1), INTENT( IN ) :: SourceType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">154</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER           :: ir, id, iArr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">155</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">156</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    WRITE( ARRFile ) MAXVAL( NArr( 1 : Nrd, 1 : Nr ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">157</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">158</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    DO id = 1, Nrd</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">159</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO ir = 1, Nr</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">160</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          IF ( SourceType == &#x27;X&#x27; ) THEN   ! line source</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">161</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             factor = 4.0 * SQRT( pi )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">162</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ELSE                            ! point source</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">163</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             IF ( r ( ir ) == 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">164</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                factor = 1e5                   ! avoid /0 at origin</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">165</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">166</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                factor = 1. / SQRT( r( ir ) )  ! cyl. spreading</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">167</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">168</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">169</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">170</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile ) NArr( id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">171</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">172</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          DO iArr = 1, NArr( id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">173</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! integers written out as reals below for fast reading in Matlab</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">174</div>
            <div class="execution-count">-</div>
            <div class="source-code">             WRITE( ARRFile ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">175</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                  factor * Arr( id, ir, iArr )%A,           &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">176</div>
            <div class="execution-count">#####</div>
            <div class="source-code">            SNGL( RadDeg * Arr( id, ir, iArr )%Phase ),       &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">177</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                           Arr( id, ir, iArr )%delay,         &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">178</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                           Arr( id, ir, iArr )%SrcDeclAngle,  &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">179</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                           Arr( id, ir, iArr )%RcvrDeclAngle, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">180</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     REAL( Arr( id, ir, iArr )%NTopBnc ),     &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">181</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     REAL( Arr( id, ir, iArr )%NBotBnc )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">182</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">183</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO   ! next arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">184</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO   ! next receiver depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">185</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO   ! next receiver range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">186</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">187</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">188</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE WriteArrivalsBinary</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">189</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">190</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">191</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">192</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE AddArr3D( omega, itheta, id, ir, Amp, Phase, delay, SrcDeclAngle, &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">193</div>
            <div class="execution-count">-</div>
            <div class="source-code">       SrcAzimAngle, RcvrDeclAngle, RcvrAzimAngle, NumTopBnc, NumBotBnc )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">194</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Adds the amplitude and delay for an ARRival into a matrix of same.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">195</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">196</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Extra logic included to keep only the strongest arrivals.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">197</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">198</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,              INTENT( IN ) :: itheta, id, ir</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">199</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,              INTENT( IN ) :: NumTopBnc, NumBotBnc</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">200</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL    ( KIND = 8 ), INTENT( IN ) :: omega, Amp, Phase, SrcDeclAngle, SrcAzimAngle, RcvrDeclAngle, RcvrAzimAngle</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">201</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">202</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX ( KIND = 8 ), INTENT( IN ) :: delay</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">203</div>
            <div class="execution-count">-</div>
            <div class="source-code">    LOGICAL                            :: NewRay</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">204</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER                            :: iArr( 1 ), Nt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">205</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL                               :: AmpTot, w1, w2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">206</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">207</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    Nt     = NArr3D( itheta, id, ir )    ! # of arrivals</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">208</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    NewRay = .TRUE.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">209</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">210</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Is this the second bracketing ray of a pair?</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">211</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! If so, we want to combine the arrivals to conserve space.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">212</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! (test this by seeing if the arrival time is close to the previous one)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">213</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! (also need that the phase is about the same to make sure surface and direct paths are not joined)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">214</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! LP: BUG: This only checks the last arrival, whereas the first step of the</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">215</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! pair could have been placed in previous slots. See readme.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">216</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">217</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( Nt &gt;= 1 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">218</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( omega * ABS( delay - Arr3D( itheta,  id, ir, Nt )%delay ) &lt; PhaseTol .AND. &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">219</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           ABS( Arr3D( itheta,  id, ir, Nt )%phase - Phase )       &lt; PhaseTol ) NewRay = .FALSE.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">220</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">221</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">222</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( NewRay ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">223</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( Nt &gt;= MaxNArr ) THEN       ! space available to add an arrival?</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">224</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          iArr = MINLOC( Arr3D( itheta,  id, ir, : )%A )                       ! no: replace weakest arrival</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">225</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          IF ( Amp &gt; Arr3D( itheta,  id, ir, iArr( 1 ) )%A ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">226</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%A             = SNGL( Amp )       ! amplitude</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">227</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%Phase         = SNGL( Phase )     ! phase</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">228</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%delay         = CMPLX( delay )    ! delay time</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">229</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%SrcDeclAngle  = SNGL( SrcDeclAngle  ) ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">230</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%SrcAzimAngle  = SNGL( SrcAzimAngle  ) ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">231</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%RcvrDeclAngle = SNGL( RcvrDeclAngle ) ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">232</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%RcvrAzimAngle = SNGL( RcvrAzimAngle ) ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">233</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%NTopBnc       = NumTopBnc         ! Number of top     bounces</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">234</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             Arr3D( itheta,  id, ir, iArr( 1 ) )%NBotBnc       = NumBotBnc         !   &quot;       bottom</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">235</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">236</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">237</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          NArr3D( itheta,  id, ir         )               = Nt + 1              ! # of arrivals</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">238</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%A             = SNGL( Amp )         ! amplitude</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">239</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%Phase         = SNGL( Phase )       ! phase</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">240</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%delay         = CMPLX( delay )      ! delay time</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">241</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%SrcDeclAngle  = SNGL( SrcDeclAngle  )   ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">242</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%SrcAzimAngle  = SNGL( SrcAzimAngle  )   ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">243</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%RcvrDeclAngle = SNGL( RcvrDeclAngle )   ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">244</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%RcvrAzimAngle = SNGL( RcvrAzimAngle )   ! angle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">245</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%NTopBnc       = NumTopBnc           ! Number of top     bounces</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">246</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Arr3D( itheta,   id, ir, Nt + 1 )%NBotBnc       = NumBotBnc           !   &quot;       bottom</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">247</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">248</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE      ! not a new ray</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">249</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !PhaseArr(   id, ir, Nt ) = PhaseArr( id, ir, Nt )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">250</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! calculate weightings of old ray information vs. new, based on amplitude of the arrival</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">251</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       AmpTot = Arr3D( itheta, id, ir, Nt )%A + SNGL( Amp )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">252</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       w1     = Arr3D( itheta, id, ir, Nt )%A / AmpTot</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">253</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       w2     = REAL( Amp ) / AmpTot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">254</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">255</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Arr3D( itheta, id, ir, Nt )%delay         = w1 * Arr3D( itheta, id, ir, Nt )%delay     + w2 * CMPLX( delay ) ! weighted sum</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">256</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Arr3D( itheta, id, ir, Nt )%A             = AmpTot</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">257</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Arr3D( itheta, id, ir, Nt )%SrcDeclAngle  = w1 * Arr3D( itheta, id, ir, Nt )%SrcDeclAngle  + w2 * SNGL( SrcDeclAngle )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">258</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Arr3D( itheta, id, ir, Nt )%SrcAzimAngle  = w1 * Arr3D( itheta, id, ir, Nt )%SrcAzimAngle  + w2 * SNGL( SrcAzimAngle )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">259</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Arr3D( itheta, id, ir, Nt )%RcvrDeclAngle = w1 * Arr3D( itheta, id, ir, Nt )%RcvrDeclAngle + w2 * SNGL( RcvrDeclAngle )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">260</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Arr3D( itheta, id, ir, Nt )%RcvrAzimAngle = w1 * Arr3D( itheta, id, ir, Nt )%RcvrAzimAngle + w2 * SNGL( RcvrAzimAngle )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">261</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">262</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">263</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">264</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE AddArr3D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">265</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">266</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">267</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">268</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE WriteArrivalsASCII3D( r, Ntheta, Nrd, Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">269</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Writes the arrival data (Amplitude, delay for each eigenray); ASCII output file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">270</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">271</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, INTENT( IN ) :: Ntheta, Nrd, Nr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">272</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL,    INTENT( IN ) :: r( Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">273</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER               :: itheta, ir, id, iArr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">274</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">275</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    WRITE( ARRFile, * ) MAXVAL( NArr3D( 1 : Ntheta,  1 : Nrd, 1 : Nr ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">276</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">277</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    DO itheta = 1, Ntheta</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">278</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO id = 1, Nrd</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">279</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          DO ir = 1, Nr</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">280</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             IF ( Beam%RunType( 6 : 6 ) == &#x27;2&#x27; ) THEN   ! 2D run?</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">281</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                IF ( r ( ir ) == 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">282</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                   factor = 1e5                   ! avoid /0 at origin</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">283</div>
            <div class="execution-count">-</div>
            <div class="source-code">                ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">284</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                   factor = 1. / SQRT( r( ir ) )  ! cyl. spreading</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">285</div>
            <div class="execution-count">-</div>
            <div class="source-code">                END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">286</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">287</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">288</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             WRITE( ARRFile, * ) NArr3D( itheta,  id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">289</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">290</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             DO iArr = 1, NArr3D( itheta,  id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">291</div>
            <div class="execution-count">-</div>
            <div class="source-code">                ! you can compress the output file a lot by putting in an explicit format statement here ...</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">292</div>
            <div class="execution-count">-</div>
            <div class="source-code">                ! However, you&#x27;ll need to make sure you keep adequate precision</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">293</div>
            <div class="execution-count">-</div>
            <div class="source-code">                WRITE( ARRFile, * ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">294</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     factor * Arr3D( itheta, id, ir, iArr )%A,             &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">295</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     RadDeg * Arr3D( itheta, id, ir, iArr )%Phase,         &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">296</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                        REAL( Arr3D( itheta, id, ir, iArr )%delay ),       &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">297</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                       AIMAG( Arr3D( itheta, id, ir, iArr )%delay ),       &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">298</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%SrcDeclAngle,  &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">299</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%SrcAzimAngle,  &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">300</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%RcvrDeclAngle, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">301</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%RcvrAzimAngle, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">302</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%NTopBnc,       &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">303</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%NBotBnc</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">304</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END DO  ! next arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">305</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO  ! next receiver depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">306</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO  ! next receiver range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">307</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO   ! next receiver angle</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">308</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">309</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">310</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE WriteArrivalsASCII3D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">311</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">312</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">313</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">314</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE WriteArrivalsBinary3D( r, Ntheta, Nrd, Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">315</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Writes the arrival data (amplitude, delay for each eigenray); Binary output file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">316</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">317</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, INTENT( IN ) :: Ntheta, Nrd, Nr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">318</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL,    INTENT( IN ) :: r( Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">319</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER               :: itheta, ir, id, iArr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">320</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">321</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    WRITE( ARRFile ) MAXVAL( NArr3D( 1 : Ntheta,  1 : Nrd, 1 : Nr ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">322</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">323</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    DO itheta = 1, Ntheta</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">324</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO id = 1, Nrd</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">325</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          DO ir = 1, Nr</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">326</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             IF ( Beam%RunType( 6 : 6 ) == &#x27;2&#x27; ) THEN   ! 2D run?</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">327</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                IF ( r ( ir ) == 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">328</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                   factor = 1e5                   ! avoid /0 at origin</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">329</div>
            <div class="execution-count">-</div>
            <div class="source-code">                ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">330</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                   factor = 1. / SQRT( r( ir ) )  ! cyl. spreading</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">331</div>
            <div class="execution-count">-</div>
            <div class="source-code">                END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">332</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">333</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">334</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             WRITE( ARRFile ) NArr3D( itheta,  id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">335</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">336</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             DO iArr = 1, NArr3D( itheta,  id, ir )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">337</div>
            <div class="execution-count">-</div>
            <div class="source-code">                ! integers written out as reals below for fast reading in Matlab</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">338</div>
            <div class="execution-count">-</div>
            <div class="source-code">                WRITE( ARRFile ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">339</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     factor * Arr3D( itheta, id, ir, iArr )%A,             &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">340</div>
            <div class="execution-count">#####</div>
            <div class="source-code">               SNGL( RadDeg * Arr3D( itheta, id, ir, iArr )%Phase ),       &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">341</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%delay,         &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">342</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%SrcDeclAngle,  &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">343</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%SrcAzimAngle,  &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">344</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%RcvrDeclAngle, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">345</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                              Arr3D( itheta, id, ir, iArr )%RcvrAzimAngle, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">346</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                        REAL( Arr3D( itheta, id, ir, iArr )%NTopBnc ),     &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">347</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                        REAL( Arr3D( itheta, id, ir, iArr )%NBotBnc )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">348</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END DO   ! next arrival</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">349</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO   ! next receiver depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">350</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO   ! next receiver range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">351</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO   ! next receiver angle</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">352</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">353</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">354</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE WriteArrivalsBinary3D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">355</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">356</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE ArrMod</div>
        </div>
    </div>

    <div class="footer">
        <p><strong>Legend:</strong></p>
        <ul>
            <li><span style="background-color: #d4edda; padding: 2px 4px;">Green</span> - Executed lines</li>
            <li><span style="background-color: #f8d7da; padding: 2px 4px;">Red</span> - Not executed lines</li>
            <li><span style="background-color: #f8f9fa; padding: 2px 4px;">Gray</span> - Non-executable lines (comments, declarations)</li>
        </ul>
        <p><strong>Execution Count:</strong> Number of times each line was executed. ##### indicates never executed, - indicates non-executable.</p>
    </div>
</body>
</html>