<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coverage Report: RWSHDFile.f90</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .metric {
            background-color: #ecf0f1;
            padding: 10px;
            border-radius: 3px;
            text-align: center;
            min-width: 120px;
        }
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        .code-container {
            background-color: white;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            overflow: auto;
        }
        .code-line {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
        }
        .line-number {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 60px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #6c757d;
        }
        .execution-count {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 80px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #495057;
        }
        .source-code {
            padding: 2px 8px;
            flex: 1;
            white-space: pre;
        }
        .executed { background-color: #d4edda; }
        .not-executed { background-color: #f8d7da; }
        .non-executable { background-color: #f8f9fa; }
        .footer {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-size: 0.9em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Coverage Report: RWSHDFile.f90</h1>
        <p>Generated from GCOV analysis of Fortran source code</p>
    </div>

    <div class="summary">
        <div class="metric">
            <div class="metric-value">27.9%</div>
            <div>Lines Executed</div>
            <div>61 total lines</div>
        </div>
        <div class="metric">
            <div class="metric-value">50.0%</div>
            <div>Branches Executed</div>
            <div>66 total branches</div>
        </div>
        <div class="metric">
            <div class="metric-value">100.0%</div>
            <div>Calls Executed</div>
            <div>40 total calls</div>
        </div>
    </div>

    <div class="code-container">
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Source:RWSHDFile.f90</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Graph:RWSHDFile.gcno</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Data:RWSHDFile.gcda</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Runs:57</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Routines for reading and writing shade file (SHDFile)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">2</div>
            <div class="execution-count">-</div>
            <div class="source-code">MODULE RWSHDFile</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">3</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Shade file I/O operations including binary format handling for acoustic field data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">4</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">5</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE SourceReceiverPositions</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">6</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE FatalError</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">7</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">8</div>
            <div class="execution-count">-</div>
            <div class="source-code">  IMPLICIT NONE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">9</div>
            <div class="execution-count">-</div>
            <div class="source-code">  PUBLIC</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">10</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">11</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER, PARAMETER, PRIVATE :: SHDFile = 25</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">12</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER :: LRecl</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">13</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">14</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! variables taken from SourceReceiverPositions:</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">15</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! freqVec vector of frequencies</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">16</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! theta   vector of bearing lines,   theta( 1 : Ntheta )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">17</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Sz      vector of source   depths, Sz(    1 : NSz    )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">18</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Rz      vector of receiver depths, Rz(    1 : NRz    )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">19</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Rr      vector of receiver ranges, Rr(    1 : NRr    )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">20</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">21</div>
            <div class="execution-count">-</div>
            <div class="source-code">CONTAINS</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">22</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE ReadHeader( FileName, Title, atten, PlotType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">23</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">24</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Read header from disk file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">25</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! This is not used anywhere in the Fortran code for the Acoustics Toolbox, since Matlab is used to process SHDFiles</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">26</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">27</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! FileName is a SHDFIL for complex pressure or a GRNFIL for a Green&#x27;s function</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">28</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Title   arbitrary title</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">29</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">30</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, PARAMETER                :: PRTFile = 6</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">31</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL,               INTENT( OUT ) :: atten           ! stabilizing attenuation for SCOOTER FFP runs</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">32</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=80), INTENT( OUT ) :: Title, FileName</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">33</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=10), INTENT( OUT ) :: PlotType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">34</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER                           :: IAllocStat, IOStat</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">35</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">36</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Open file, read header</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">37</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( FileName( 1 : 1 ) == &#x27; &#x27; ) FileName = &#x27;SHDFIL&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">38</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">39</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! INQUIRE( FILE = FileName, RECL = IRECL )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">40</div>
            <div class="execution-count">-</div>
            <div class="source-code">    OPEN( UNIT = SHDFile,   FILE = FileName, STATUS = &#x27;OLD&#x27;, ACCESS = &#x27;DIRECT&#x27;, FORM = &#x27;UNFORMATTED&#x27;, RECL = 4, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">41</div>
            <div class="execution-count">#####</div>
            <div class="source-code">         IOSTAT = IOStaT, ACTION = &#x27;READ&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">42</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( IOStat /= 0 ) CALL ERROUT( &#x27;ReadHeader&#x27;, &#x27;Unable to open shade file&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">43</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">44</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 1 ) LRecl</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">45</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    CLOSE( UNIT = SHDFile )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">46</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    OPEN(  UNIT = SHDFile,   FILE = FileName, STATUS = &#x27;OLD&#x27;, ACCESS = &#x27;DIRECT&#x27;, FORM = &#x27;UNFORMATTED&#x27;, RECL = 4 * LRecl )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">47</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">48</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 1  ) LRecl, Title</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">49</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 2  ) PlotType</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">50</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 3  ) Nfreq, Pos%Ntheta, Pos%NSx, Pos%NSy, Pos%NSz, Pos%NRz, Pos%NRr, atten</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">51</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">52</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ALLOCATE( freqVec( Nfreq ), Pos%Sz( Pos%NSz ), Pos%Rz( Pos%NRz ), Pos%Rr( Pos%NRr ), &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">53</div>
            <div class="execution-count">#####</div>
            <div class="source-code">            &amp; Pos%theta( Pos%Ntheta ), Stat = IAllocStat )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">54</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( IAllocStat /= 0 ) CALL ERROUT( &#x27;ReadHeader&#x27;, &#x27;Too many source/receiver combinations&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">55</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">56</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 4  ) freqVec</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">57</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 5  ) Pos%theta</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">58</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 6  ) Pos%Sx</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">59</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 7  ) Pos%Sy</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">60</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 8  ) Pos%Sz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">61</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 9  ) Pos%Rz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">62</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    READ( SHDFile, REC = 10 ) Pos%Rr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">63</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">64</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Pos%deltaR = Pos%r( Pos%NRr ) - Pos%r( Pos%NRr - 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">65</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">66</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE ReadHeader</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">67</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">68</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">69</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">70</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE WriteHeader( FileName, Title, freq0, atten, PlotType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">71</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">72</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Write header to disk file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">73</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">74</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL,      INTENT( IN ) :: freq0, atten      ! Nominal frequency, stabilizing attenuation (for wavenumber integration only)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">75</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER, INTENT( IN ) :: FileName*( * )    ! Name of the file (could be a shade file or a Green&#x27;s function file)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">76</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER, INTENT( IN ) :: Title*( * )       ! Arbitrary title</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">77</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER(LEN=10), INTENT(IN) :: PlotType   ! If &#x27;TL&#x27;, writes only first and last Sx and Sy</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">78</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">79</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! receiver bearing angles</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">80</div>
            <div class="execution-count">8</div>
            <div class="source-code">    IF ( .NOT. ALLOCATED( Pos%theta ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">81</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( Pos%theta( 1 ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">82</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Pos%theta( 1 ) = 0   ! dummy bearing angle</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">83</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">84</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">85</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! source x-coordinates</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">86</div>
            <div class="execution-count">8</div>
            <div class="source-code">    IF ( .NOT. ALLOCATED( Pos%Sx ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">87</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( Pos%Sx( 1 ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">88</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Pos%sx( 1 ) = 0      ! dummy x-coordinate</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">89</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">90</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">91</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! source y-coordinates</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">92</div>
            <div class="execution-count">8</div>
            <div class="source-code">    IF ( .NOT. ALLOCATED( Pos%Sy ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">93</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( Pos%Sy( 1 ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">94</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Pos%sy( 1 ) = 0      ! dummy y-coordinate</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">95</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">96</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">97</div>
            <div class="execution-count">8</div>
            <div class="source-code">    IF ( PlotType( 1 : 2 ) /= &#x27;TL&#x27; ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">98</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! MAX( 41, ... ) below because Title is already 40 words (or 80 bytes)</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">99</div>
            <div class="execution-count">8</div>
            <div class="source-code">       LRecl = MAX( 41, 2 * Nfreq, Pos%Ntheta, Pos%NSx, Pos%NSy, Pos%NSz, Pos%NRz, 2 * Pos%NRr )   ! words/record (NRr doubled for complex pressure storage)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">100</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">101</div>
            <div class="execution-count">8</div>
            <div class="source-code">       OPEN ( FILE = FileName, UNIT = SHDFile, STATUS = &#x27;REPLACE&#x27;, ACCESS = &#x27;DIRECT&#x27;, RECL = 4 * LRecl, FORM = &#x27;UNFORMATTED&#x27;)</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">102</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( SHDFile, REC = 1  ) LRecl, Title( 1 : 80 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">103</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( SHDFile, REC = 2  ) PlotType</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">104</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( SHDFile, REC = 3  ) Nfreq, Pos%Ntheta, Pos%NSx, Pos%NSy, Pos%NSz, Pos%NRz, Pos%NRr, freq0, atten</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">105</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 4  ) freqVec(   1 : Nfreq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">106</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 5  ) Pos%theta( 1 : Pos%Ntheta )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">107</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">108</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 6  ) Pos%Sx( 1 : Pos%NSx )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">109</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 7  ) Pos%Sy( 1 : Pos%NSy )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">110</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 8  ) Pos%Sz( 1 : Pos%NSz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">111</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">112</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 9  ) Pos%Rz( 1 : Pos%NRz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">113</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       WRITE( SHDFile, REC = 10 ) Pos%Rr( 1 : Pos%NRr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">114</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">115</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE   ! compressed format for TL from FIELD3D</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">116</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       LRecl = MAX( 41, 2 * Nfreq, Pos%Ntheta, Pos%NSz, Pos%NRz, 2 * Pos%NRr )   ! words/record (NR doubled for complex pressure storage)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">117</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">118</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       OPEN ( FILE = FileName, UNIT = SHDFile, STATUS = &#x27;REPLACE&#x27;, ACCESS = &#x27;DIRECT&#x27;, RECL = 4 * LRecl, FORM = &#x27;UNFORMATTED&#x27;)</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">119</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 1  ) LRecl, Title( 1 : 80 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">120</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 2  ) PlotType</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">121</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 3  ) Nfreq, Pos%Ntheta, Pos%NSx, Pos%NSy, Pos%NSz, Pos%NRz, Pos%NRr, freq0, atten</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">122</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 4  ) freqVec(   1 : Nfreq )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">123</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 5  ) Pos%theta( 1 : Pos%Ntheta )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">124</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">125</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 6  ) Pos%Sx( 1 ), Pos%Sx( Pos%NSx )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">126</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 7  ) Pos%Sy( 1 ), Pos%Sy( Pos%NSy )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">127</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 8  ) Pos%Sz( 1 : Pos%NSz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">128</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">129</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 9  ) Pos%Rz( 1 : Pos%NRz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">130</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = 10 ) Pos%Rr( 1 : Pos%NRr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">131</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">132</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">133</div>
            <div class="execution-count">8</div>
            <div class="source-code">  END SUBROUTINE WriteHeader</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">134</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">135</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">136</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">137</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE WriteField( P, NRz, NRr, IRec )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">138</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">139</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Write the field to disk</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">140</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">141</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, INTENT( IN )    :: NRz, NRr        ! Number of receiver depths, ranges</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">142</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX, INTENT( IN )    :: P( NRz, NRr )   ! Pressure field</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">143</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, INTENT( INOUT ) :: iRec            ! last record read</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">144</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER                  :: iRz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">145</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">146</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    DO iRz = 1, NRz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">147</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       iRec = iRec + 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">148</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( SHDFile, REC = iRec ) P( iRz, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">149</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">150</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">151</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE WriteField</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">152</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">153</div>
            <div class="execution-count">-</div>
            <div class="source-code">END MODULE RWSHDFile</div>
        </div>
    </div>

    <div class="footer">
        <p><strong>Legend:</strong></p>
        <ul>
            <li><span style="background-color: #d4edda; padding: 2px 4px;">Green</span> - Executed lines</li>
            <li><span style="background-color: #f8d7da; padding: 2px 4px;">Red</span> - Not executed lines</li>
            <li><span style="background-color: #f8f9fa; padding: 2px 4px;">Gray</span> - Non-executable lines (comments, declarations)</li>
        </ul>
        <p><strong>Execution Count:</strong> Number of times each line was executed. ##### indicates never executed, - indicates non-executable.</p>
    </div>
</body>
</html>