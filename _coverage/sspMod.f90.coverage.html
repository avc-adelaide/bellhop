<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coverage Report: sspMod.f90</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .metric {
            background-color: #ecf0f1;
            padding: 10px;
            border-radius: 3px;
            text-align: center;
            min-width: 120px;
        }
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        .code-container {
            background-color: white;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            overflow: auto;
        }
        .code-line {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
        }
        .line-number {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 60px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #6c757d;
        }
        .execution-count {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 80px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #495057;
        }
        .source-code {
            padding: 2px 8px;
            flex: 1;
            white-space: pre;
        }
        .executed { background-color: #d4edda; }
        .not-executed { background-color: #f8d7da; }
        .non-executable { background-color: #f8f9fa; }
        .footer {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-size: 0.9em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Coverage Report: sspMod.f90</h1>
        <p>Generated from GCOV analysis of Fortran source code</p>
    </div>

    <div class="summary">
        <div class="metric">
            <div class="metric-value">36.8%</div>
            <div>Lines Executed</div>
            <div>418 total lines</div>
        </div>
        <div class="metric">
            <div class="metric-value">54.1%</div>
            <div>Branches Executed</div>
            <div>580 total branches</div>
        </div>
        <div class="metric">
            <div class="metric-value">100.0%</div>
            <div>Calls Executed</div>
            <div>83 total calls</div>
        </div>
    </div>

    <div class="code-container">
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Source:sspMod.f90</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Graph:sspMod.gcno</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Data:sspMod.gcda</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Runs:57</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Sound speed profile module with interpolation and derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">2</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">3</div>
            <div class="execution-count">-</div>
            <div class="source-code">MODULE sspmod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">4</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Sound speed profile handling with interpolation, derivatives, and environment management</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">5</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">6</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Holds SSP input by user and associated variables</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">7</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">8</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! This module is very similar to the one used by the other programs in the Acoustics Toolbox</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">9</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! However, it returns the SSP *and* its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">10</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">11</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Also, a greater premium has been placed on returning this info quickly, since BELLHOP calls it at every step</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">12</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Therefore more information is pre-computed</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">13</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">14</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE FatalError</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">15</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE monotonicMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">16</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE splinec</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">17</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">18</div>
            <div class="execution-count">-</div>
            <div class="source-code">  IMPLICIT NONE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">19</div>
            <div class="execution-count">-</div>
            <div class="source-code">  PUBLIC</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">20</div>
            <div class="execution-count">-</div>
            <div class="source-code">  SAVE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">21</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">22</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER, PARAMETER, PRIVATE :: ENVFile = 5, PRTFile = 6</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">23</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER, PARAMETER     :: MaxSSP = 100001</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">24</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER                :: iSegr = 1, iSegx = 1, iSegy = 1, iSegz = 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">25</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER,       PRIVATE :: iz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">26</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), PRIVATE :: Depth, W</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">27</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8)          :: zTemp, betaPowerLaw = 1, fT = 1D20</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">28</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8)          :: alphaR = 1500, betaR = 0, alphaI = 0, betaI = 0, rhoR = 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">29</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">30</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE rxyz_vector</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">31</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL(KIND=8), ALLOCATABLE :: r(:), x(:), y(:), z(:)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">32</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE rxyz_vector</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">33</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">34</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! SSP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">35</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE SSPStructure</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">36</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER              :: NPts, Nr, Nx, Ny, Nz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">37</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL    (KIND=8)     :: z( MaxSSP ), rho( MaxSSP )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">38</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX (KIND=8)     :: c( MaxSSP ), cz( MaxSSP ), n2( MaxSSP ), n2z( MaxSSP ), cSpline( 4, MaxSSP )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">39</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX (KIND=8)     :: cCoef( 4, MaxSSP ), CSWork( 4, MaxSSP )   ! for PCHIP coefs.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">40</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), ALLOCATABLE :: cMat( :, : ), czMat( :, : ), cMat3( :, :, : ), czMat3( :, :, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">41</div>
            <div class="execution-count">-</div>
            <div class="source-code">    TYPE ( rxyz_vector ) :: Seg</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">42</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=1)    :: Type</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">43</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=2)    :: AttenUnit</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">44</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE SSPStructure</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">45</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">46</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE( SSPStructure ) :: SSP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">47</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">48</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! *** Halfspace properties structure ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">49</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">50</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE HSInfo</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">51</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL     (KIND=8) :: alphaR, alphaI, betaR, betaI  ! compressional and shear wave speeds/attenuations in user units</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">52</div>
            <div class="execution-count">-</div>
            <div class="source-code">     COMPLEX  (KIND=8) :: cP, cS                 ! P-wave, S-wave speeds</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">53</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL     (KIND=8) :: rho, Depth             ! density, depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">54</div>
            <div class="execution-count">-</div>
            <div class="source-code">     CHARACTER (LEN=1) :: BC                     ! Boundary condition type</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">55</div>
            <div class="execution-count">-</div>
            <div class="source-code">     CHARACTER (LEN=6) :: Opt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">56</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE HSInfo</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">57</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">58</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE BdryPt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">59</div>
            <div class="execution-count">-</div>
            <div class="source-code">     TYPE( HSInfo )   :: HS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">60</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE BdryPt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">61</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">62</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE BdryType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">63</div>
            <div class="execution-count">-</div>
            <div class="source-code">     TYPE( BdryPt )   :: Top, Bot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">64</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE BdryType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">65</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">66</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE(BdryType) :: Bdry</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">67</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">68</div>
            <div class="execution-count">-</div>
            <div class="source-code">CONTAINS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">69</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">70</div>
            <div class="execution-count">89148356*</div>
            <div class="source-code">  SUBROUTINE EvaluateSSP( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">71</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Evaluates sound speed profile at given location</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">72</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">73</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Call the particular profil routine indicated by the SSP%Type and perform Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">74</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !   Task = &#x27;TAB&#x27;  then tabulate cp, cs, rhoT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">75</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !   Task = &#x27;INI&#x27; then initialize</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">76</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">77</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">78</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: x( 2 )      ! r-z coordinate where SSP is to be evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">79</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">80</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER ( LEN=3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">81</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">82</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8)                :: gradc_3d( 3 ), cxx, cyy, cxy, cxz, cyz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">83</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8)                :: x3( 3 ), t3( 3 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">84</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">85</div>
            <div class="execution-count">37583</div>
            <div class="source-code">    SELECT CASE ( SSP%Type )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">86</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;N&#x27; )  !  N2-linear profile option</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">87</div>
            <div class="execution-count">6283761</div>
            <div class="source-code">       CALL n2Linear( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">88</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;C&#x27; )  !  C-linear profile option</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">89</div>
            <div class="execution-count">6246178*</div>
            <div class="source-code">       CALL cLinear(  x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">90</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;P&#x27; )  !  monotone PCHIP ACS profile option</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">91</div>
            <div class="execution-count">80575431*</div>
            <div class="source-code">       CALL cPCHIP(   x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">92</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;S&#x27; )  !  Cubic spline profile option</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">93</div>
            <div class="execution-count">82864595</div>
            <div class="source-code">       CALL cCubic(   x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">94</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;Q&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">95</div>
            <div class="execution-count">2289164*</div>
            <div class="source-code">       CALL Quad(     x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">96</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;H&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">97</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( Task == &#x27;TAB&#x27; ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">98</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;BELLHOP: EvaluateSSP: Hexahedral is not a valid SSP in 2D mode&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">99</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;BELLHOP: EvaluateSSP&#x27;, &#x27;Hexahedral is not a valid SSP in 2D mode&#x27;)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">100</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">101</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! this is called by BELLHOP3D only once, during READIN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">102</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! possibly the logic should be changed to call EvaluateSSP2D or 3D</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">103</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       x3 = [ 0.0D0, 0.0D0, x( 2 ) ]</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">104</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       t3 = [ 0.0D0, 0.0D0, t( 2 ) ]</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">105</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Hexahedral( x3, t3, c, cimag, gradc_3d, cxx, cyy, czz, cxy, cxz, cyz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">106</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )  !  Analytic profile option</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">107</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Analytic( x, t, c, cimag, gradc, crr, crz, czz, rho )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">108</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">109</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Profile option: &#x27;, SSP%Type</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">110</div>
            <div class="execution-count">89148356*</div>
            <div class="source-code">       CALL ERROUT( &#x27;BELLHOP: EvaluateSSP&#x27;, &#x27;Invalid profile option&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">111</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">112</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">113</div>
            <div class="execution-count">89148356</div>
            <div class="source-code">  END SUBROUTINE EvaluateSSP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">114</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">115</div>
            <div class="execution-count">-</div>
            <div class="source-code">! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">116</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">117</div>
            <div class="execution-count">#####</div>
            <div class="source-code">SUBROUTINE EvaluateSSP2D( x2D, t2D, c, cimag, gradc, crr, crz, czz, rho, xs, tradial, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">118</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Converts cartesian gradients to polar</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">119</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">120</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Called from BELLHOP3D to get a 2D slice out of the 3D SSP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">121</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">122</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( IN  ) :: x2D( 2 ), t2D( 2 ), xs( 3 ), tradial( 2 ), freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">123</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), czz, crz, crr, rho</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">124</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8)                :: x( 3 ), t( 3 ), gradc3D(3 ), cxx, cyy, cxy, cxz, cyz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">125</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">126</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! convert polar coordinate to cartesian</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">127</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  x = [ xs( 1 ) + x2D( 1 ) * tradial( 1 ), xs( 2 ) + x2D( 1 ) * tradial( 2 ), x2D( 2 ) ]</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">128</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  t = [           t2D( 1 ) * tradial( 1 ),           t2D( 1 ) * tradial( 2 ), t2D( 2 ) ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">129</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">130</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  CALL EvaluateSSP3D( x, t, c, cimag, gradc3D, cxx, cyy, czz, cxy, cxz, cyz, rho, freq, &#x27;TAB&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">131</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">132</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  gradc( 1 )  = DOT_PRODUCT( tradial, gradc3D( 1 : 2 ) )  ! r derivative</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">133</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  gradc( 2 )  = gradc3D( 3 )                              ! z derivative</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">134</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">135</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  crz = tradial( 1 ) * cxz + tradial( 2 ) * cyz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">136</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  crr = cxx * ( tradial( 1 ) )**2 + 2.0 * cxy * tradial( 1 ) * tradial( 2 ) + cyy * ( tradial( 2 ) )**2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">137</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">138</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">139</div>
            <div class="execution-count">-</div>
            <div class="source-code">END SUBROUTINE EvaluateSSP2D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">140</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">141</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">142</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">143</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE EvaluateSSP3D( x, t, c, cimag, gradc, cxx, cyy, czz, cxy, cxz, cyz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">144</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">145</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Call the particular profil routine indicated by the SSP%Type and perform Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">146</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !   Task = &#x27;TAB&#x27;  then tabulate cp, cs, rhoT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">147</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !   Task = &#x27;INI&#x27; then initialize</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">148</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">149</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">150</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: x( 3 )      ! x-y-z coordinate where SSP is to be evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">151</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: t( 3 )      ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">152</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER ( LEN=3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">153</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 3 ), cxx, cyy, czz, cxy, cxz, cyz, rho</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">154</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8)                :: x_rz( 2 ), t_rz( 2 ), gradc_rz( 2 ), crr, crz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">155</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">156</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    x_rz = [ 0.0D0, x( 3 ) ]   ! convert x-y-z coordinate to cylindrical coordinate</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">157</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    t_rz = [ 0.0D0, t( 3 ) ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">158</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">159</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( SSP%Type )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">160</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;N&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">161</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL n2Linear( x_rz, t_rz, c, cimag, gradc_rz, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">162</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;C&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">163</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL cLinear(  x_rz, t_rz, c, cimag, gradc_rz, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">164</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;S&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">165</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL cCubic(   x_rz, t_rz, c, cimag, gradc_rz, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">166</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;H&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">167</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Hexahedral( x, t, c, cimag, gradc, cxx, cyy, czz, cxy, cxz, cyz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">168</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">169</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Analytic3D( x, t, c, cimag, gradc, cxx, cyy, czz, cxy, cxz, cyz, rho )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">170</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">171</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Profile option: &#x27;, SSP%Type</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">172</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ERROUT( &#x27;BELLHOP3D: EvaluateSSP3D&#x27;, &#x27;Invalid profile option&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">173</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">174</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">175</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( SSP%Type )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">176</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;N&#x27;, &#x27;C&#x27;, &#x27;S&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">177</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       gradc = [ 0.0D0, 0.0D0, gradc_rz( 2 ) ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">178</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">179</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cxx   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">180</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cyy   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">181</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cxy   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">182</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cxz   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">183</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cyz   = 0.0D0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">184</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">185</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">186</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE EvaluateSSP3D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">187</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">188</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">189</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">190</div>
            <div class="execution-count">37583*</div>
            <div class="source-code">  SUBROUTINE n2Linear( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">191</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Linear interpolation for squared buoyancy frequency</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">192</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">193</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! N2-linear interpolation of SSP data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">194</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">195</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">196</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: x( 2 )   ! r-z coordinate where sound speed is evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">197</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">198</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">199</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho ! sound speed and its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">200</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">201</div>
            <div class="execution-count">37583</div>
            <div class="source-code">    IF ( Task == &#x27;INI&#x27; ) THEN   ! read in SSP data</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">202</div>
            <div class="execution-count">1</div>
            <div class="source-code">       Depth     = x( 2 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">203</div>
            <div class="execution-count">1</div>
            <div class="source-code">       CALL ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">204</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">205</div>
            <div class="execution-count">3*</div>
            <div class="source-code">       SSP%n2(  1 : SSP%NPts ) = 1.0 / SSP%c( 1 : SSP%NPts ) ** 2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">206</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">207</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! compute gradient, n2z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">208</div>
            <div class="execution-count">2*</div>
            <div class="source-code">       DO iz = 2, SSP%Npts</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">209</div>
            <div class="execution-count">3*</div>
            <div class="source-code">          SSP%n2z( iz - 1 ) = ( SSP%n2(   iz ) - SSP%n2(   iz - 1 ) ) / &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">210</div>
            <div class="execution-count">5*</div>
            <div class="source-code">                              ( SSP%z(    iz ) - SSP%z(    iz - 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">211</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">212</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE                         ! return SSP info</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">213</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">214</div>
            <div class="execution-count">37582</div>
            <div class="source-code">       CALL UpdateDepthSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">215</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">216</div>
            <div class="execution-count">37582*</div>
            <div class="source-code">       W = ( x( 2 ) - SSP%z( iSegz ) ) / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">217</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">218</div>
            <div class="execution-count">37582*</div>
            <div class="source-code">       c     = REAL(  1.0D0 / SQRT( ( 1.0D0 - W ) * SSP%n2( iSegz ) + W * SSP%n2( iSegz + 1 ) ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">219</div>
            <div class="execution-count">37582*</div>
            <div class="source-code">       cimag = AIMAG( 1.0D0 / SQRT( ( 1.0D0 - W ) * SSP%n2( iSegz ) + W * SSP%n2( iSegz + 1 ) ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">220</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">221</div>
            <div class="execution-count">112746*</div>
            <div class="source-code">       gradc = [ 0.0D0, -0.5D0 * c * c * c * REAL( SSP%n2z( iSegz ) ) ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">222</div>
            <div class="execution-count">37582</div>
            <div class="source-code">       crr   = 0.0d0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">223</div>
            <div class="execution-count">37582</div>
            <div class="source-code">       crz   = 0.0d0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">224</div>
            <div class="execution-count">37582</div>
            <div class="source-code">       czz   = 3.0d0 * gradc( 2 ) * gradc( 2 ) / C</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">225</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">226</div>
            <div class="execution-count">37582*</div>
            <div class="source-code">       rho   = ( 1.0D0 - W ) * SSP%rho( iSegz ) + W * SSP%rho( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">227</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">228</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">229</div>
            <div class="execution-count">37583</div>
            <div class="source-code">  END SUBROUTINE n2Linear</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">230</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">231</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">232</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">233</div>
            <div class="execution-count">6246178*</div>
            <div class="source-code">  SUBROUTINE cLinear( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">234</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! c-linear interpolation of SSP data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">235</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">236</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">237</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: x( 2 )   ! r-z coordinate where sound speed is evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">238</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">239</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">240</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho ! sound speed and its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">241</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">242</div>
            <div class="execution-count">6246178</div>
            <div class="source-code">    IF ( Task == &#x27;INI&#x27; ) THEN   ! read in SSP data</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">243</div>
            <div class="execution-count">2</div>
            <div class="source-code">       Depth     = x( 2 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">244</div>
            <div class="execution-count">2</div>
            <div class="source-code">       CALL ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">245</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE                        ! return SSP info</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">246</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">247</div>
            <div class="execution-count">6246176</div>
            <div class="source-code">       CALL UpdateDepthSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">248</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">249</div>
            <div class="execution-count">6246176*</div>
            <div class="source-code">       c     = REAL(  SSP%c( iSegz ) + ( x( 2 ) - SSP%z( iSegz ) ) * SSP%cz( iSegz ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">250</div>
            <div class="execution-count">6246176*</div>
            <div class="source-code">       cimag = AIMAG( SSP%c( iSegz ) + ( x( 2 ) - SSP%z( iSegz ) ) * SSP%cz( iSegz ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">251</div>
            <div class="execution-count">18738528*</div>
            <div class="source-code">       gradc = [ 0.0D0, REAL( SSP%cz( iSegz ) ) ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">252</div>
            <div class="execution-count">6246176</div>
            <div class="source-code">       crr   = 0.0d0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">253</div>
            <div class="execution-count">6246176</div>
            <div class="source-code">       crz   = 0.0d0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">254</div>
            <div class="execution-count">6246176</div>
            <div class="source-code">       czz   = 0.0d0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">255</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">256</div>
            <div class="execution-count">6246176*</div>
            <div class="source-code">       W     = ( x( 2 ) - SSP%z( iSegz ) ) / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">257</div>
            <div class="execution-count">6246176*</div>
            <div class="source-code">       rho   = ( 1.0D0 - W ) * SSP%rho( iSegz ) + W * SSP%rho( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">258</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">259</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">260</div>
            <div class="execution-count">6246178</div>
            <div class="source-code">  END SUBROUTINE cLinear</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">261</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">262</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">263</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">264</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE cPCHIP( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">265</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! PCHIP for interpolation of sound speed</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">266</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">267</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! This implements the new monotone piecewise cubic Hermite interpolating</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">268</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! polynomial (PCHIP) algorithm for the interpolation of the sound speed c.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">269</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">270</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE pchipMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">271</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">272</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: x( 2 )   ! r-z coordinate where sound speed is evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">273</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">274</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">275</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho ! sound speed and its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">276</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8) :: xt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">277</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX  (KIND=8) :: c_cmplx</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">278</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">279</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( Task == &#x27;INI&#x27; ) THEN   ! read in SSP data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">280</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">281</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Depth     = x( 2 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">282</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">283</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">284</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !                                                               2      3</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">285</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! compute coefficients of std cubic polynomial: c0 + c1*x + c2*x + c3*x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">286</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">287</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">288</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL PCHIP( SSP%z, SSP%c, SSP%NPts, SSP%cCoef, SSP%CSWork )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">289</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">290</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE                        ! return SSP info</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">291</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">292</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL UpdateDepthSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">293</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">294</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       xt = x( 2 ) - SSP%z( iSegz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">295</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c_cmplx = SSP%cCoef( 1, iSegz ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">296</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             + ( SSP%cCoef( 2, iSegz ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">297</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             + ( SSP%cCoef( 3, iSegz ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">298</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             +   SSP%cCoef( 4, iSegz ) * xt ) * xt ) * xt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">299</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">300</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c     = REAL(  c_cmplx )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">301</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cimag = AIMAG( c_cmplx )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">302</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">303</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       gradc = [ 0.0D0, REAL( SSP%cCoef( 2, iSegz ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">304</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                  + ( 2.0D0 * SSP%cCoef( 3, iSegz ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">305</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                    + 3.0D0 * SSP%cCoef( 4, iSegz ) * xt ) * xt ) ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">306</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">307</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       crr   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">308</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       crz   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">309</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       czz   = REAL( 2.0D0 * SSP%cCoef( 3, iSegz ) + 6.0D0 * SSP%cCoef( 4, iSegz ) * xt )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">310</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">311</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       W     = ( x( 2 ) - SSP%z( iSegz ) ) / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">312</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       rho   = ( 1.0D0 - W ) * SSP%rho( iSegz ) + W * SSP%rho( iSegz + 1 )   ! linear interp of density</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">313</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">314</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">315</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">316</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE cPCHIP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">317</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">318</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">319</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">320</div>
            <div class="execution-count">80575431*</div>
            <div class="source-code">  SUBROUTINE cCubic( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">321</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Cubic spline interpolation for sound speed</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">322</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">323</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN )  :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">324</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: x( 2 )   ! r-z coordinate where sound speed is evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">325</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">326</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">327</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho ! sound speed and its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">328</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER                          :: iBCBeg, iBCEnd</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">329</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8)                :: hSpline</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">330</div>
            <div class="execution-count">-</div>
            <div class="source-code">    COMPLEX  (KIND=8)                :: c_cmplx, cz_cmplx, czz_cmplx</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">331</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">332</div>
            <div class="execution-count">80575431</div>
            <div class="source-code">    IF ( Task == &#x27;INI&#x27; ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">333</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">334</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! *** Task &#x27;INIT&#x27; for initialization ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">335</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">336</div>
            <div class="execution-count">24</div>
            <div class="source-code">       Depth     = x( 2 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">337</div>
            <div class="execution-count">24</div>
            <div class="source-code">       CALL ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">338</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">339</div>
            <div class="execution-count">75*</div>
            <div class="source-code">       SSP%cSpline( 1, 1 : SSP%NPts ) = SSP%c( 1 : SSP%NPts )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">340</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">341</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Compute spline coefs</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">342</div>
            <div class="execution-count">24</div>
            <div class="source-code">       iBCBeg = 0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">343</div>
            <div class="execution-count">24</div>
            <div class="source-code">       iBCEnd = 0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">344</div>
            <div class="execution-count">24</div>
            <div class="source-code">       CALL CSpline( SSP%z, SSP%cSpline(   1, 1 ), SSP%NPts, iBCBeg, iBCEnd, SSP%NPts )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">345</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">346</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">347</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! *** Section to return SSP info ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">348</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">349</div>
            <div class="execution-count">80575407</div>
            <div class="source-code">       CALL UpdateDepthSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">350</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">351</div>
            <div class="execution-count">80575407*</div>
            <div class="source-code">       hSpline = x( 2 ) - SSP%z( iSegz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">352</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">353</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! c   = Spline(   SSP%cSpline( 1, iSegz ), hSpline )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">354</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! cz  = SplineX(  SSP%cSpline( 1, iSegz ), hSpline )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">355</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! czz = SplineXX( SSP%cSpline( 1, iSegz ), hSpline )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">356</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">357</div>
            <div class="execution-count">80575407*</div>
            <div class="source-code">       CALL SplineALL( SSP%cSpline( 1, iSegz ), hSpline, c_cmplx, cz_cmplx, czz_cmplx )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">358</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">359</div>
            <div class="execution-count">80575407</div>
            <div class="source-code">       c     = DBLE(  c_cmplx )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">360</div>
            <div class="execution-count">80575407</div>
            <div class="source-code">       cimag = AIMAG( c_cmplx )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">361</div>
            <div class="execution-count">241726221</div>
            <div class="source-code">       gradc = [ 0.0D0, DBLE( cz_cmplx ) ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">362</div>
            <div class="execution-count">80575407</div>
            <div class="source-code">       czz   = DBLE( czz_cmplx )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">363</div>
            <div class="execution-count">80575407</div>
            <div class="source-code">       crr   = 0.0d0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">364</div>
            <div class="execution-count">80575407</div>
            <div class="source-code">       crz   = 0.0d0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">365</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">366</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! linear interpolation for density</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">367</div>
            <div class="execution-count">80575407*</div>
            <div class="source-code">       W   = ( x( 2 ) - SSP%z( iSegz ) ) / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">368</div>
            <div class="execution-count">80575407*</div>
            <div class="source-code">       rho = ( 1.0D0 - W ) * SSP%rho( iSegz ) + W * SSP%rho( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">369</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">370</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">371</div>
            <div class="execution-count">80575431</div>
            <div class="source-code">  END SUBROUTINE cCubic</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">372</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">373</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">374</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">375</div>
            <div class="execution-count">2289164*</div>
            <div class="source-code">  SUBROUTINE Quad( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">376</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Quadrilateral interpolation for sound speed profiles</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">377</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">378</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Bilinear quadrilateral interpolation of SSP data in 2D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">379</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">380</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,           PARAMETER      :: SSPFile = 40</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">381</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">382</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: x( 2 )   ! r-z coordinate where sound speed is evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">383</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">384</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=3),  INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">385</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho ! sound speed and its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">386</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER                           :: AllocateStatus, iSegT, iz2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">387</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8)                :: c1, c2, cz1, cz2, cr, cz, s1, s2, delta_r, delta_z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">388</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">389</div>
            <div class="execution-count">2289164</div>
            <div class="source-code">    IF ( Task == &#x27;INI&#x27; ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">390</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">391</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !  *** read in SSP data ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">392</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">393</div>
            <div class="execution-count">1</div>
            <div class="source-code">       Depth = x( 2 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">394</div>
            <div class="execution-count">1</div>
            <div class="source-code">       CALL ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">395</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">396</div>
            <div class="execution-count">-</div>
            <div class="source-code">      ! Read the 2D SSP matrix</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">397</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;__________________________________________________________________________&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">398</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">399</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Using range-dependent sound speed&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">400</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">401</div>
            <div class="execution-count">1</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Nr</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">402</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Number of SSP ranges = &#x27;, SSP%Nr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">403</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">404</div>
            <div class="execution-count">1</div>
            <div class="source-code">       IF ( SSP%Nr &lt; 2 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">405</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Quad&#x27;, &#x27;You must have at least two profiles in your 2D SSP field&#x27;  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">406</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">407</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">408</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       ALLOCATE( SSP%cMat( SSP%NPts, SSP%Nr ), SSP%czMat( SSP%NPts - 1, SSP%Nr ), SSP%Seg%r( SSP%Nr ), STAT = AllocateStatus )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">409</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       IF ( AllocateStatus /= 0 ) CALL ERROUT( &#x27;sspMod: Quad&#x27;, &#x27;Insufficient memory to store SSP&#x27;  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">410</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">411</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Seg%r( 1 : SSP%Nr )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">412</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">413</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Profile ranges (km):&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">414</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       WRITE( PRTFile, FMT=&quot;( F10.2 )&quot;  ) SSP%Seg%r( 1 : SSP%Nr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">415</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">416</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       IF ( .NOT. monotonic( SSP%Seg%r, SSP%Nr ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">417</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Quad&#x27;, &#x27;The ranges in the SSP must be monotone increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">418</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">419</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">420</div>
            <div class="execution-count">31*</div>
            <div class="source-code">       SSP%Seg%r = 1000.0 * SSP%Seg%r   ! convert km to m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">421</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">422</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">423</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Sound speed matrix:&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">424</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27; Depth (m )     Soundspeed (m/s)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">425</div>
            <div class="execution-count">3*</div>
            <div class="source-code">       DO iz2 = 1, SSP%NPts</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">426</div>
            <div class="execution-count">2*</div>
            <div class="source-code">          READ(  SSPFile, * ) SSP%cMat( iz2, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">427</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ! WRITE( PRTFile, FMT=&quot;( &#x27;iSegz depth = &#x27;, F10.2, &#x27; m&#x27; )&quot;  ) SSP%z( iz2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">428</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ! WRITE( PRTFile, FMT=&quot;( 12F10.2 )&quot;  ) SSP%cMat( iz2, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">429</div>
            <div class="execution-count">3*</div>
            <div class="source-code">          WRITE( PRTFile, FMT=&quot;( 12F10.2 )&quot;  ) SSP%z( iz2 ), SSP%cMat( iz2, : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">430</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">431</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">432</div>
            <div class="execution-count">1</div>
            <div class="source-code">       CLOSE( SSPFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">433</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">434</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! calculate cz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">435</div>
            <div class="execution-count">31*</div>
            <div class="source-code">       DO iSegt = 1, SSP%Nr</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">436</div>
            <div class="execution-count">61*</div>
            <div class="source-code">          DO iz2 = 2, SSP%NPts</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">437</div>
            <div class="execution-count">30*</div>
            <div class="source-code">             delta_z = ( SSP%z( iz2 ) - SSP%z( iz2 - 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">438</div>
            <div class="execution-count">60*</div>
            <div class="source-code">             SSP%czMat( iz2 - 1, iSegt ) = ( SSP%cMat( iz2, iSegt ) - SSP%cMat( iz2 - 1, iSegt ) ) / delta_z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">439</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">440</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">441</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">442</div>
            <div class="execution-count">1</div>
            <div class="source-code">       SSP%Nz = SSP%NPts</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">443</div>
            <div class="execution-count">1</div>
            <div class="source-code">       RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">444</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">445</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">446</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">447</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! *** Section to return SSP info ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">448</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">449</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       CALL UpdateDepthSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">450</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">451</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Check that x is inside the box where the sound speed is defined</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">452</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       IF ( x( 1 ) &lt; SSP%Seg%r( 1 ) .OR. x( 1 ) &gt; SSP%Seg%r( SSP%Nr ) ) THEN ! .OR. &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">453</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;ray is outside the box where the ocean soundspeed is defined&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">454</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27; x = ( r, z ) = &#x27;, x</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">455</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Quad&#x27;, &#x27;ray is outside the box where the soundspeed is defined&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">456</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">457</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">458</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       CALL UpdateRangeSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">459</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">460</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! for this depth, x( 2 ), get the sound speed at both ends of the segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">461</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       cz1 = SSP%czMat( iSegz, iSegr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">462</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       cz2 = SSP%czMat( iSegz, iSegr + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">463</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">464</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       s2      = x( 2 ) - SSP%z( iSegz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">465</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       delta_z = SSP%z( iSegz + 1 ) - SSP%z( iSegz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">466</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">467</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       c1 = SSP%cMat( iSegz, iSegr     ) + s2 * cz1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">468</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       c2 = SSP%cMat( iSegz, iSegr + 1 ) + s2 * cz2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">469</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">470</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! s1 = proportional distance of x( 1 ) in range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">471</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       delta_r = ( SSP%Seg%r( iSegr + 1 ) - SSP%Seg%r( iSegr ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">472</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       s1 = ( x( 1 ) - SSP%Seg%r( iSegr ) ) / delta_r</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">473</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       s1 = MIN( s1, 1.0D0 )   ! force piecewise constant extrapolation for points outside the box</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">474</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       s1 = MAX( s1, 0.0D0 )   ! &quot;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">475</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">476</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       c     = ( 1.0D0 - s1 ) * c1  + s1 * c2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">477</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">478</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! interpolate the attenuation !!!! This will use the wrong segment if the ssp in the envil is sampled at different depths</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">479</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       s2    = s2 / delta_z   ! convert to a proportional depth in the layer</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">480</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       cimag = AIMAG( ( 1.0D0 - s2 ) * SSP%c( Isegz )  + s2 * SSP%c( Isegz + 1 ) )   ! volume attenuation is taken from the single c(z) profile</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">481</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">482</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       cz  = ( 1.0D0 - s1 ) * cz1 + s1 * cz2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">483</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">484</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       cr  = ( c2  - c1  ) / delta_r</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">485</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       crz = ( cz2 - cz1 ) / delta_r</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">486</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">487</div>
            <div class="execution-count">6867489</div>
            <div class="source-code">       gradc = [ cr, cz ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">488</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       crr   = 0.0D0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">489</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">       czz   = 0.0D0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">490</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">491</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! linear interpolation for density</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">492</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       W   = ( x( 2 ) - SSP%z( iSegz ) ) / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">493</div>
            <div class="execution-count">2289163*</div>
            <div class="source-code">       rho = ( 1.0D0 - W ) * SSP%rho( iSegz ) + W * SSP%rho( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">494</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">495</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">496</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE Quad</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">497</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">498</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">499</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">500</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE Hexahedral( x, t, c, cimag, gradc, cxx, cyy, czz, cxy, cxz, cyz, rho, freq, Task )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">501</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Trilinear hexahedral interpolation of SSP data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">502</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">503</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! assumes a rectilinear case (not the most general hexahedral)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">504</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">505</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,            PARAMETER     :: SSPFile = 40</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">506</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">507</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: x( 3 )   ! x-y-z coordinate where sound speed is evaluated</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">508</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN  ) :: t( 3 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">509</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN =3), INTENT( IN  ) :: Task</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">510</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 3 ), cxx, cyy, czz, cxy, cxz, cyz, rho ! sound speed and its derivatives</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">511</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER                           :: AllocateStatus, iSegxt, iSegyt, iy2, iz2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">512</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8)                :: c1, c2, c11, c12, c21, c22, cz11, cz12, cz21, cz22, cz1, cz2, &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">513</div>
            <div class="execution-count">-</div>
            <div class="source-code">                                         cx, cy, cz, s1, s2, s3</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">514</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">515</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    IF ( Task == &#x27;INI&#x27; ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">516</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">517</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !  *** Section to read in SSP data ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">518</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">519</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Read dummy SSP information from the environmental file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">520</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! This is over-ridden by the info in the SSP file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">521</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! However, cz info is used in beam selection</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">522</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Depth = x( 3 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">523</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">524</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">525</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Read the 3D SSP matrix</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">526</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">527</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">528</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Reading sound speed profile from file&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">529</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">530</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! x coordinates</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">531</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Nx</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">532</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">533</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Number of points in x = &#x27;, SSP%Nx</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">534</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( SSP%Seg%x( SSP%Nx ), STAT = AllocateStatus )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">535</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( AllocateStatus /= 0 ) CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;Insufficient memory to store SSP&#x27;  )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">536</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Seg%x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">537</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">538</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, * ) &#x27;x-coordinates of SSP (km):&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">539</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, FMT=&quot;( F10.2 )&quot;  ) SSP%Seg%x( 1 : SSP%Nx )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">540</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( .NOT. monotonic( SSP%Seg%x, SSP%Nx ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">541</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;The x coordinates in the SSP must be monotone increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">542</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">543</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">544</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! y coordinates</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">545</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Ny</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">546</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">547</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Number of points in y = &#x27;, SSP%Ny</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">548</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( SSP%Seg%y( SSP%Ny ), STAT = AllocateStatus )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">549</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( AllocateStatus /= 0 ) CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;Insufficient memory to store SSP&#x27;  )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">550</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Seg%y</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">551</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">552</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, * ) &#x27;y-coordinates of SSP (km):&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">553</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, FMT=&quot;( F10.2 )&quot;  ) SSP%Seg%y( 1 : SSP%Ny )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">554</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( .NOT. monotonic( SSP%Seg%y, SSP%Ny ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">555</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;The y coordinates in the SSP must be monotone increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">556</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">557</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">558</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! z coordinates</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">559</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Nz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">560</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">561</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Number of points in z = &#x27;, SSP%Nz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">562</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( SSP%Seg%z( SSP%Nz ), STAT = AllocateStatus )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">563</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( AllocateStatus /= 0 ) CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;Insufficient memory to store SSP&#x27;  )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">564</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( SSPFile,  * ) SSP%Seg%z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">565</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">566</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, * ) &#x27;z-coordinates of SSP (km):&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">567</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !WRITE( PRTFile, FMT=&quot;( F10.2 )&quot;  ) SSP%Seg%z( 1 : SSP%Nz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">568</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( .NOT. monotonic( SSP%Seg%z, SSP%Nz ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">569</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;The z coordinates in the SSP must be monotone increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">570</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">571</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">572</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! SSP matrix should be bigger than 2x2x2</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">573</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( SSP%Nx &lt; 2 .OR. SSP%Ny &lt; 2 .OR. SSP%Nz &lt; 2 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">574</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">575</div>
            <div class="execution-count">#####</div>
            <div class="source-code">               &#x27;You must have at least two points in x, y, z directions in your 3D SSP field&#x27;  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">576</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">577</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">578</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( SSP%Nz &gt;= MaxSSP ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">579</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ! LP: SSP%Nz / SSP%Seg%z will get assigned to SSP%NPts / SSP%z.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">580</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">581</div>
            <div class="execution-count">#####</div>
            <div class="source-code">               &#x27;Number of SSP points in Z exceeds limit&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">582</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">583</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">584</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( SSP%cMat3( SSP%Nx, SSP%Ny, SSP%Nz ), SSP%czMat3( SSP%Nx, SSP%Ny, SSP%Nz - 1 ), STAT = AllocateStatus )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">585</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( AllocateStatus /= 0 ) CALL ERROUT( &#x27;sspMod: Hexahedral&#x27;, &#x27;Insufficient memory to store SSP&#x27;  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">586</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">587</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">588</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! WRITE( PRTFile, * ) &#x27;Sound speed matrix:&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">589</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO iz2 = 1, SSP%Nz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">590</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          DO iy2 = 1, SSP%Ny</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">591</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             READ(  SSPFile, * ) SSP%cMat3( :, iy2, iz2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">592</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! WRITE( PRTFile, FMT=&quot;( &#x27;z-section = &#x27;, F10.2, &#x27;  m&#x27; )&quot;  ) SSP%Seg%z( iz2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">593</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! WRITE( PRTFile, FMT=&quot;( &#x27;y-section = &#x27;, F10.2, &#x27; km&#x27; )&quot;  ) SSP%Seg%y( iy2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">594</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! WRITE( PRTFile, FMT=&quot;( 12F10.2 )&quot;  ) SSP%cMat3( :, iy2, iz2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">595</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">596</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">597</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">598</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CLOSE( SSPFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">599</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">600</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%Seg%x = 1000.0 * SSP%Seg%x   ! convert km to m</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">601</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%Seg%y = 1000.0 * SSP%Seg%y   ! convert km to m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">602</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">603</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! calculate cz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">604</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO iSegxt = 1, SSP%Nx</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">605</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          DO iSegyt = 1, SSP%Ny</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">606</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             DO iz2 = 2, SSP%Nz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">607</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                SSP%czMat3( iSegxt, iSegyt, iz2 - 1 ) = &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">608</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     ( SSP%cMat3( iSegxt, iSegyt, iz2 ) - SSP%cMat3( iSegxt, iSegyt, iz2 - 1 ) ) / &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">609</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                     ( SSP%Seg%z(                 iz2 ) - SSP%Seg%z(                 iz2 - 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">610</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">611</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">612</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">613</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">614</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! over-ride the SSP%z values read in from the environmental file with these new values</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">615</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%NPts = SSP%Nz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">616</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%z( 1 : SSP%Nz ) = SSP%Seg%z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">617</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">618</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">619</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">620</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">621</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! *** Section to return SSP info ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">622</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">623</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Check that x is inside the box where the sound speed is defined</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">624</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( x( 1 ) &lt; SSP%Seg%x( 1 ) .OR. x( 1 ) &gt; SSP%Seg%x( SSP%Nx ) .OR. &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">625</div>
            <div class="execution-count">#####</div>
            <div class="source-code">            x( 2 ) &lt; SSP%Seg%y( 1 ) .OR. x( 2 ) &gt; SSP%Seg%y( SSP%Ny ) ) THEN ! .OR. &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">626</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$          x( 3 ) &lt; SSP%Seg%z( 1 ) .OR. x( 3 ) &gt; SSP%Seg%z( SSP%Nz ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">627</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;ray is outside the box where the ocean soundspeed is defined&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">628</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27; x = ( x, y, z ) = &#x27;, x</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">629</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;Hexahedral&#x27;, &#x27;ray is outside the box where the soundspeed is defined&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">630</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">631</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">632</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Update3DXSegmentT( x, t )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">633</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Update3DYSegmentT( x, t )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">634</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL Update3DZSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">635</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">636</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! cz at the corners of the current rectangle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">637</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz11 = SSP%czMat3( iSegx,     iSegy    , iSegz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">638</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz12 = SSP%czMat3( iSegx + 1, iSegy    , iSegz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">639</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz21 = SSP%czMat3( iSegx,     iSegy + 1, iSegz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">640</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz22 = SSP%czMat3( iSegx + 1, iSegy + 1, iSegz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">641</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">642</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! for this depth, x( 3 ) get the sound speed at the corners of the current rectangle</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">643</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s3 = x( 3 ) - SSP%Seg%z( iSegz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">644</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c11 = SSP%cMat3( iSegx,     iSegy    , iSegz ) + s3 * cz11</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">645</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c21 = SSP%cMat3( iSegx + 1, iSegy    , iSegz ) + s3 * cz12</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">646</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c12 = SSP%cMat3( iSegx,     iSegy + 1, iSegz ) + s3 * cz21</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">647</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c22 = SSP%cMat3( iSegx + 1, iSegy + 1, iSegz ) + s3 * cz22</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">648</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">649</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! s1 = proportional distance of x( 1 ) in x</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">650</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s1 = ( x( 1 ) - SSP%Seg%x( iSegx ) ) / ( SSP%Seg%x( iSegx + 1 ) - SSP%Seg%x( iSegx ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">651</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s1 = MIN( s1, 1.0D0 )   ! force piecewise constant extrapolation for points outside the box</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">652</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s1 = MAX( s1, 0.0D0 )   ! &quot;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">653</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">654</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! s2 = proportional distance of x( 2 ) in y</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">655</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s2 = ( x( 2 ) - SSP%Seg%y( iSegy ) ) / ( SSP%Seg%y( iSegy + 1 ) - SSP%Seg%y( iSegy ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">656</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s2 = MIN( s2, 1.0D0 )   ! force piecewise constant extrapolation for points outside the box</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">657</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s2 = MAX( s2, 0.0D0 )   ! &quot;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">658</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">659</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! interpolate the soundspeed in the x direction, at the two endpoints in y (top and bottom sides of rectangle)</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">660</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c1 = c11 + s1 * ( c21 - c11 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">661</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c2 = c12 + s1 * ( c22 - c12 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">662</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !c  = ( 1.0D0 - s2 ) * c1  + s2 * c2   ! interpolation in y</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">663</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cy = ( c2 - c1 ) / ( SSP%Seg%y( iSegy + 1 ) - SSP%Seg%y( iSegy ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">664</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">665</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! interpolate the soundspeed in the y direction, at the two endpoints in x (left and right sides of rectangle)</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">666</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c1 = c11 + s2 * ( c12 - c11 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">667</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c2 = c21 + s2 * ( c22 - c21 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">668</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">669</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       c  = c1  + s1 * ( c2 - c1   )   ! interpolation in x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">670</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">671</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! interpolate the attenuation !!!! This will use the wrong segment if the ssp in the envfil is sampled at different depths</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">672</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       s3 = s3 / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )   ! convert s3 to a proportional distance in the layer</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">673</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cimag = AIMAG( ( 1.0D0 - s3 ) * SSP%c( Isegz )  + s3 * SSP%c( Isegz + 1 ) )   ! volume attenuation is taken from the single c(z) profile</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">674</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">675</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cx = ( c2 - c1 ) / ( SSP%Seg%x( iSegx + 1 ) - SSP%Seg%x( iSegx ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">676</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">677</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! same thing on cz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">678</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz1 = cz11 + s2 * ( cz21 - cz11 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">679</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz2 = cz12 + s2 * ( cz22 - cz12 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">680</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cz  = cz1  + s1 * ( cz2  - cz1  )   ! interpolation in z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">681</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">682</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !gradc = [ cx, cy, cz ]</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">683</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       gradc( 1 ) = cx</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">684</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       gradc( 2 ) = cy</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">685</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       gradc( 3 ) = cz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">686</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">687</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cxx   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">688</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cyy   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">689</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       czz   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">690</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cxy   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">691</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cxz   = 0.0D0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">692</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       cyz   = 0.0D0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">693</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! write( *, FMT=&quot;( &#x27;SSP&#x27;, I3, 2X, 4F10.2, F10.4 )&quot; ) layer, x, c, cz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">694</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">695</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! linear interpolation for density</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">696</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       W   = ( x( 3 ) - SSP%z( iSegz ) ) / ( SSP%z( iSegz + 1 ) - SSP%z( iSegz ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">697</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       rho = ( 1.0D0 - W ) * SSP%rho( iSegz ) + W * SSP%rho( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">698</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">699</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">700</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE Hexahedral</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">701</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">702</div>
            <div class="execution-count">-</div>
            <div class="source-code">! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">703</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">704</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE Analytic( x, t, c, cimag, gradc, crr, crz, czz, rho )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">705</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">706</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( IN  ) :: x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">707</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">708</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">709</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8)                :: c0, cr, cz, DxtDz, xt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">710</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">711</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    iSegz = 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">712</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    c0    = 1500.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">713</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    rho   = 1.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">714</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">715</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! homogeneous halfspace was removed since BELLHOP needs to get gradc just a little below the boundaries, on ray reflection</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">716</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">717</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$  IF ( x( 2 ) &lt; 5000.0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">718</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    xt    = 2.0 * ( x( 2 ) - 1300.0 ) / 1300.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">719</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    DxtDz = 2.0 / 1300.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">720</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    c     = C0 * ( 1.0 + 0.00737*( xt - 1.0 + EXP( -xt ) ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">721</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    cimag = 0.</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">722</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    cz    = C0 * 0.00737 * ( 1.0 - EXP( -xt ) ) * DxtDz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">723</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    czz   = C0 * 0.00737 * EXP( -xt ) * DxtDz ** 2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">724</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$  ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">725</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     ! Homogeneous half-space</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">726</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     xt   = 2.0 * ( 5000.0 - 1300.0 ) / 1300.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">727</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     c    = C0 * ( 1.0 + 0.00737 * ( xt - 1.0 + EXP( -xt ) ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">728</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     cimag = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">729</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     cz   = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">730</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     czz  = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">731</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$  END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">732</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">733</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    cr = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">734</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    gradc = [ cr, cz ]</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">735</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    crz = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">736</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    crr = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">737</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">738</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">739</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE Analytic</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">740</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">741</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">742</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">743</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE AnalyticCosh( x, t, c, cimag, gradc, crr, crz, czz, rho )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">744</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">745</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( IN  ) :: x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">746</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( IN  ) :: t( 2 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">747</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 2 ), crr, crz, czz, rho</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">748</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8)                :: cr, cz, A, B, D, z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">749</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">750</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    iSegz = 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">751</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    rho   = 1.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">752</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">753</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    D = 3000.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">754</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    z = x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">755</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">756</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    A = 1500.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">757</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    B = 0.0003</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">758</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    D = 1500.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">759</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">760</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    c   =         A * COSH( B * ( Z - D ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">761</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    cz  =     B * A * SINH( B * ( Z - D ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">762</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    czz = B * B * A * COSH( B * ( Z - D ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">763</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">764</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    cimag = 0.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">765</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">766</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    cr = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">767</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    gradc = [ cr, cz ]</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">768</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    crz = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">769</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    crr = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">770</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">771</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">772</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE AnalyticCosh</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">773</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">774</div>
            <div class="execution-count">-</div>
            <div class="source-code">! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">775</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">776</div>
            <div class="execution-count">#####</div>
            <div class="source-code">SUBROUTINE Analytic3D( x, t, c, cimag, gradc, cxx, cyy, czz, cxy, cxz, cyz, rho )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">777</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">778</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( IN ) :: x( 3 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">779</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( OUT ) :: c, cimag, gradc( 3 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">780</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( OUT ) :: cxx, cyy, czz, cxy, cxz, cyz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">781</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( IN ) :: t( 3 )   ! ray tangent; for edge cases of updating segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">782</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8), INTENT( INOUT ) :: rho</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">783</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">784</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8) :: c0, W, Wz, epsilon, epsilon_y</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">785</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">786</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  iSegz = 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">787</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  c0    = 1500.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">788</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  rho   = 1.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">789</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">790</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$  IF ( x( 3 ) .LT. 5000.0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">791</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     epsilon   = 0.00737 + x( 2 ) / 100000.0 * 0.003</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">792</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     epsilon_y = 0.003 / 100000.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">793</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">794</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     W   = 2.0 * ( x( 3 ) - 1300.0 ) / 1300.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">795</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     Wz  = 2.0 / 1300.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">796</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">797</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     c           = c0 * ( 1.0 + epsilon * ( W - 1.0 + EXP( -W ) ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">798</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     cimag       = 0.</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">799</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     gradc( 2 )  = c0 * epsilon_y * ( W - 1.0 + EXP( -W ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">800</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     gradc( 3 )  = c0 * epsilon * ( 1.0 - EXP( -W ) ) * Wz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">801</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     czz         = c0 * epsilon * EXP( -W ) * Wz **2</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">802</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     cyz         = c0 * epsilon_y * ( 1.0 - EXP( -W ) ) * Wz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">803</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$  ELSE    ! HOMOGENEOUS HALF-SPACE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">804</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     W           = 2.0 * ( 5000.0 - 1300.0 ) / 1300.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">805</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     c           = c0*( 1.0 + 0.00737 * ( W - 1.0 + EXP( -W ) ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">806</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     gradc( 2 )  = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">807</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     gradc( 3 )  = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">808</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     czz         = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">809</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$     cyz         = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">810</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!$  END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">811</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">812</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  gradc( 1 )  = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">813</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  cxx = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">814</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  cyy = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">815</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  cxz = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">816</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  cxy = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">817</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">818</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">819</div>
            <div class="execution-count">-</div>
            <div class="source-code">END SUBROUTINE Analytic3D</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">820</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">821</div>
            <div class="execution-count">-</div>
            <div class="source-code">! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">822</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">823</div>
            <div class="execution-count">28</div>
            <div class="source-code">  SUBROUTINE ReadSSP( Depth, freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">824</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Reads SSP data from the environmental file and convert to Nepers/m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">825</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">826</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE AttenMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">827</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">828</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT(IN) :: freq, Depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">829</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">830</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">831</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * ) &#x27;Sound speed profile:&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">832</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">833</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, &quot;( &#x27;      z         alphaR      betaR     rho        alphaI     betaI&#x27;    )&quot; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">834</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, &quot;( &#x27;     (m)         (m/s)      (m/s)   (g/cm^3)      (m/s)     (m/s)&#x27;, / )&quot; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">835</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">836</div>
            <div class="execution-count">28</div>
            <div class="source-code">    SSP%NPts = 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">837</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">838</div>
            <div class="execution-count">83*</div>
            <div class="source-code">    DO iz = 1, MaxSSP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">839</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">840</div>
            <div class="execution-count">83*</div>
            <div class="source-code">       READ(  ENVFile, *    ) SSP%z( iz ), alphaR, betaR, rhoR, alphaI, betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">841</div>
            <div class="execution-count">83*</div>
            <div class="source-code">       WRITE( PRTFile, FMT=&quot;( F10.2, 3X, 2F10.2, 3X, F6.2, 3X, 2F10.4 )&quot; ) SSP%z( iz ), alphaR, betaR, rhoR, alphaI, betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">842</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">843</div>
            <div class="execution-count">83*</div>
            <div class="source-code">       SSP%c(   iz ) = CRCI( SSP%z( iz ), alphaR, alphaI, freq, freq, SSP%AttenUnit, betaPowerLaw, fT )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">844</div>
            <div class="execution-count">83*</div>
            <div class="source-code">       SSP%rho( iz ) = rhoR</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">845</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">846</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! verify that the depths are monotone increasing</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">847</div>
            <div class="execution-count">83</div>
            <div class="source-code">       IF ( iz &gt; 1 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">848</div>
            <div class="execution-count">55*</div>
            <div class="source-code">          IF ( SSP%z( iz ) &lt;= SSP%z( iz - 1 ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">849</div>
            <div class="execution-count">#####</div>
            <div class="source-code">              WRITE( PRTFile, * ) &#x27;Bad depth in SSP: &#x27;, SSP%z( iz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">850</div>
            <div class="execution-count">#####</div>
            <div class="source-code">              CALL ERROUT( &#x27;ReadSSP&#x27;, &#x27;The depths in the SSP must be monotone increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">851</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">852</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">853</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">854</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! compute gradient, cz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">855</div>
            <div class="execution-count">248*</div>
            <div class="source-code">       IF ( iz &gt; 1 ) SSP%cz( iz - 1 )  = ( SSP%c( iz ) - SSP%c( iz - 1 ) ) / &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">856</div>
            <div class="execution-count">220*</div>
            <div class="source-code">                                         ( SSP%z( iz ) - SSP%z( iz - 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">857</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">858</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Did we read the last point?</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">859</div>
            <div class="execution-count">83*</div>
            <div class="source-code">       IF ( ABS( SSP%z( iz ) - Depth ) &lt; 100. * EPSILON( 1.0e0 ) ) THEN</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">860</div>
            <div class="execution-count">28</div>
            <div class="source-code">          SSP%Nz = SSP%NPts</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">861</div>
            <div class="execution-count">28</div>
            <div class="source-code">          IF ( SSP%NPts == 1 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">862</div>
            <div class="execution-count">#####</div>
            <div class="source-code">              WRITE( PRTFile, * ) &#x27;#SSP points: &#x27;, SSP%NPts</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">863</div>
            <div class="execution-count">#####</div>
            <div class="source-code">              CALL ERROUT( &#x27;ReadSSP&#x27;, &#x27;The SSP must have at least 2 points&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">864</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">865</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">866</div>
            <div class="execution-count">28</div>
            <div class="source-code">          RETURN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">867</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">868</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">869</div>
            <div class="execution-count">55*</div>
            <div class="source-code">       SSP%NPts = SSP%NPts + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">870</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">871</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">872</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Fall through means too many points in the profile</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">873</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    WRITE( PRTFile, * ) &#x27;Max. #SSP points: &#x27;, MaxSSP</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">874</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    CALL ERROUT( &#x27;ReadSSP&#x27;, &#x27;Number of SSP points exceeds limit&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">875</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">876</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END SUBROUTINE ReadSSP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">877</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">878</div>
            <div class="execution-count">89148328</div>
            <div class="source-code">  SUBROUTINE UpdateDepthSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">879</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL (KIND=8), INTENT(IN) :: x( 2 ), t( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">880</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">881</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! LP: Handles edge cases based on which direction the ray is going. If the</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">882</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! ray takes a small step in the direction of t, it will remain in the same</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">883</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! segment as it is now.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">884</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">885</div>
            <div class="execution-count">89148328</div>
            <div class="source-code">     IF ( t( 2 ) &gt;= 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">886</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%z( iSegz ) &lt;= x( 2 ) &lt; SSP%z( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">887</div>
            <div class="execution-count">46592792*</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &lt; SSP%z( iSegz ) .AND. iSegz &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">888</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegz = iSegz - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">889</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">890</div>
            <div class="execution-count">47079039*</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &gt;= SSP%z( iSegz + 1 ) .AND. iSegz &lt; SSP%Npts-1 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">891</div>
            <div class="execution-count">486247</div>
            <div class="source-code">           iSegz = iSegz + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">892</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">893</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">894</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%z( iSegz ) &lt; x( 2 ) &lt;= SSP%z( iSegz + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">895</div>
            <div class="execution-count">42555536*</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &gt; SSP%z( iSegz + 1 ) .AND. iSegz &lt; SSP%Npts-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">896</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegz = iSegz + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">897</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">898</div>
            <div class="execution-count">42938069*</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &lt;= SSP%z( iSegz ) .AND. iSegz &gt; 1 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">899</div>
            <div class="execution-count">382533</div>
            <div class="source-code">           iSegz = iSegz - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">900</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">901</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">902</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">903</div>
            <div class="execution-count">89148328</div>
            <div class="source-code">  END SUBROUTINE UpdateDepthSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">904</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">905</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">  SUBROUTINE UpdateRangeSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">906</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL (KIND=8), INTENT(IN) :: x( 2 ), t( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">907</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">908</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! LP: See UpdateDepthSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">909</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">910</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">     IF ( t( 1 ) &gt;= 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">911</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%r( iSegr ) &lt;= x( 1 ) &lt; SSP%Seg%r( iSegr + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">912</div>
            <div class="execution-count">2269935*</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &lt; SSP%Seg%r( iSegr ) .AND. iSegr &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">913</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegr = iSegr - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">914</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">915</div>
            <div class="execution-count">2281188*</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &gt;= SSP%Seg%r( iSegr + 1 ) .AND. iSegr &lt; SSP%Nr-1 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">916</div>
            <div class="execution-count">11253</div>
            <div class="source-code">           iSegr = iSegr + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">917</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">918</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">919</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%r( iSegr ) &lt; x( 1 ) &lt;= SSP%Seg%r( iSegr + 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">920</div>
            <div class="execution-count">19228*</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &gt; SSP%Seg%r( iSegr + 1 ) .AND. iSegr &lt; SSP%Nr-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">921</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegr = iSegr + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">922</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">923</div>
            <div class="execution-count">25112*</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &lt;= SSP%Seg%r( iSegr ) .AND. iSegr &gt; 1 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">924</div>
            <div class="execution-count">5884</div>
            <div class="source-code">           iSegr = iSegr - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">925</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">926</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">927</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">928</div>
            <div class="execution-count">2289163</div>
            <div class="source-code">  END SUBROUTINE UpdateRangeSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">929</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">930</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE Update3DXSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">931</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL (KIND=8), INTENT(IN) :: x( 3 ), t( 3 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">932</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">933</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! LP: See UpdateDepthSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">934</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">935</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     IF ( t( 1 ) &gt;= 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">936</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%x( iSegx ) &lt;= x( 1 ) &lt; SSP%Seg%x( iSegx + 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">937</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &lt; SSP%Seg%x( iSegx ) .AND. iSegx &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">938</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegx = iSegx - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">939</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">940</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &gt;= SSP%Seg%x( iSegx + 1 ) .AND. iSegx &lt; SSP%Nx-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">941</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegx = iSegx + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">942</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">943</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">944</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%x( iSegx ) &lt; x( 1 ) &lt;= SSP%Seg%x( iSegx + 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">945</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &gt; SSP%Seg%x( iSegx + 1 ) .AND. iSegx &lt; SSP%Nx-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">946</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegx = iSegx + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">947</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">948</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 1 ) &lt;= SSP%Seg%x( iSegx ) .AND. iSegx &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">949</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegx = iSegx - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">950</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">951</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">952</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">953</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE Update3DXSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">954</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">955</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE Update3DYSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">956</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL (KIND=8), INTENT(IN) :: x( 3 ), t( 3 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">957</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">958</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! LP: See UpdateDepthSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">959</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">960</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     IF ( t( 2 ) &gt;= 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">961</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%y( iSegy ) &lt;= x( 2 ) &lt; SSP%Seg%y( iSegy + 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">962</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &lt; SSP%Seg%y( iSegy ) .AND. iSegy &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">963</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegy = iSegy - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">964</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">965</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &gt;= SSP%Seg%y( iSegy + 1 ) .AND. iSegy &lt; SSP%Ny-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">966</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegy = iSegy + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">967</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">968</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">969</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%y( iSegy ) &lt; x( 2 ) &lt;= SSP%Seg%y( iSegy + 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">970</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &gt; SSP%Seg%y( iSegy + 1 ) .AND. iSegy &lt; SSP%Ny-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">971</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegy = iSegy + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">972</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">973</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 2 ) &lt;= SSP%Seg%y( iSegy ) .AND. iSegy &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">974</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegy = iSegy - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">975</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">976</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">977</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">978</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE Update3DYSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">979</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">980</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  SUBROUTINE Update3DZSegmentT( x, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">981</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL (KIND=8), INTENT(IN) :: x( 3 ), t( 3 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">982</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">983</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ! LP: See UpdateDepthSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">984</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">985</div>
            <div class="execution-count">#####</div>
            <div class="source-code">     IF ( t( 3 ) &gt;= 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">986</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%z( iSegz ) &lt;= x( 3 ) &lt; SSP%Seg%z( iSegz + 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">987</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 3 ) &lt; SSP%Seg%z( iSegz ) .AND. iSegz &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">988</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegz = iSegz - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">989</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">990</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 3 ) &gt;= SSP%Seg%z( iSegz + 1 ) .AND. iSegz &lt; SSP%Nz-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">991</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegz = iSegz + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">992</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">993</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">994</div>
            <div class="execution-count">-</div>
            <div class="source-code">        ! SSP%Seg%z( iSegz ) &lt; x( 3 ) &lt;= SSP%Seg%z( iSegz + 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">995</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 3 ) &gt; SSP%Seg%z( iSegz + 1 ) .AND. iSegz &lt; SSP%Nz-1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">996</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegz = iSegz + 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">997</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">998</div>
            <div class="execution-count">#####</div>
            <div class="source-code">        DO WHILE ( x( 3 ) &lt;= SSP%Seg%z( iSegz ) .AND. iSegz &gt; 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">999</div>
            <div class="execution-count">#####</div>
            <div class="source-code">           iSegz = iSegz - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1000</div>
            <div class="execution-count">-</div>
            <div class="source-code">        END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1001</div>
            <div class="execution-count">-</div>
            <div class="source-code">     ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1002</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1003</div>
            <div class="execution-count">#####</div>
            <div class="source-code">  END SUBROUTINE Update3DZSegmentT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1004</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">1005</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE sspmod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1006</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
    </div>

    <div class="footer">
        <p><strong>Legend:</strong></p>
        <ul>
            <li><span style="background-color: #d4edda; padding: 2px 4px;">Green</span> - Executed lines</li>
            <li><span style="background-color: #f8d7da; padding: 2px 4px;">Red</span> - Not executed lines</li>
            <li><span style="background-color: #f8f9fa; padding: 2px 4px;">Gray</span> - Non-executable lines (comments, declarations)</li>
        </ul>
        <p><strong>Execution Count:</strong> Number of times each line was executed. ##### indicates never executed, - indicates non-executable.</p>
    </div>
</body>
</html>