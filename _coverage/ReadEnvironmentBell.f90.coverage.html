<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coverage Report: ReadEnvironmentBell.f90</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .metric {
            background-color: #ecf0f1;
            padding: 10px;
            border-radius: 3px;
            text-align: center;
            min-width: 120px;
        }
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        .code-container {
            background-color: white;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            overflow: auto;
        }
        .code-line {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
        }
        .line-number {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 60px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #6c757d;
        }
        .execution-count {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 80px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #495057;
        }
        .source-code {
            padding: 2px 8px;
            flex: 1;
            white-space: pre;
        }
        .executed { background-color: #d4edda; }
        .not-executed { background-color: #f8d7da; }
        .non-executable { background-color: #f8f9fa; }
        .footer {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-size: 0.9em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Coverage Report: ReadEnvironmentBell.f90</h1>
        <p>Generated from GCOV analysis of Fortran source code</p>
    </div>

    <div class="summary">
        <div class="metric">
            <div class="metric-value">55.3%</div>
            <div>Lines Executed</div>
            <div>300 total lines</div>
        </div>
        <div class="metric">
            <div class="metric-value">50.0%</div>
            <div>Branches Executed</div>
            <div>172 total branches</div>
        </div>
        <div class="metric">
            <div class="metric-value">99.6%</div>
            <div>Calls Executed</div>
            <div>257 total calls</div>
        </div>
    </div>

    <div class="code-container">
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Source:ReadEnvironmentBell.f90</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Graph:ReadEnvironmentBell.gcno</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Data:ReadEnvironmentBell.gcda</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Runs:57</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Environment input file parsing and setup for BELLHOP</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">2</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">3</div>
            <div class="execution-count">-</div>
            <div class="source-code">MODULE ReadEnvironmentBell</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">4</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Provides environment file reading and initialization</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">5</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">6</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE BellhopMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">7</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE MathConstants</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">8</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE sspmod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">9</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE AttenMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">10</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE FatalError</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">11</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">12</div>
            <div class="execution-count">-</div>
            <div class="source-code">  IMPLICIT NONE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">13</div>
            <div class="execution-count">-</div>
            <div class="source-code">  PUBLIC</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">14</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">15</div>
            <div class="execution-count">-</div>
            <div class="source-code">CONTAINS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">16</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">17</div>
            <div class="execution-count">57*</div>
            <div class="source-code">  SUBROUTINE ReadEnvironment( FileRoot, ThreeD )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">18</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Reads and parses the main environment file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">19</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">20</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Routine to read in and echo all the input data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">21</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Note that default values of SSP, DENSITY, Attenuation will not work</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">22</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">23</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE anglemod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">24</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE SourceReceiverPositions</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">25</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">26</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), PARAMETER   :: c0 = 1500.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">27</div>
            <div class="execution-count">-</div>
            <div class="source-code">    LOGICAL,            INTENT(IN ) :: ThreeD</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">28</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=80), INTENT(IN ) :: FileRoot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">29</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER            :: NPts, NMedia, iostat</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">30</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL               :: ZMin, ZMax</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">31</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8) :: x( 2 ), t( 2 ), c, cimag, gradc( 2 ), crr, crz, czz, rho, sigma, Depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">32</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 2) :: AttenUnit</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">33</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=10) :: PlotType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">34</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">35</div>
            <div class="execution-count">57</div>
            <div class="source-code">    WRITE( PRTFile, * ) &#x27;BELLHOP/BELLHOP3D&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">36</div>
            <div class="execution-count">57</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">37</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">38</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Open the environmental file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">39</div>
            <div class="execution-count">57*</div>
            <div class="source-code">    OPEN( UNIT = ENVFile, FILE = TRIM( FileRoot ) // &#x27;.env&#x27;, STATUS = &#x27;OLD&#x27;, IOSTAT = iostat, ACTION = &#x27;READ&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">40</div>
            <div class="execution-count">57</div>
            <div class="source-code">    IF ( IOSTAT /= 0 ) THEN   ! successful open?</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">41</div>
            <div class="execution-count">29*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;ENVFile = &#x27;, TRIM( FileRoot ) // &#x27;.env&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">42</div>
            <div class="execution-count">29</div>
            <div class="source-code">       CALL ERROUT( &#x27;BELLHOP - READIN&#x27;, &#x27;Unable to open the environmental file&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">43</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">44</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">45</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Prepend model name to title</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">46</div>
            <div class="execution-count">28</div>
            <div class="source-code">    IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">47</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Title( 1 : 11 ) = &#x27;BELLHOP3D- &#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">48</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ(  ENVFile, * ) Title( 12 : 80 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">49</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">50</div>
            <div class="execution-count">28</div>
            <div class="source-code">       Title( 1 :  9 ) = &#x27;BELLHOP- &#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">51</div>
            <div class="execution-count">28</div>
            <div class="source-code">       READ(  ENVFile, * ) Title( 10 : 80 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">52</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">53</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">54</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * ) Title</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">55</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">56</div>
            <div class="execution-count">28</div>
            <div class="source-code">    READ(  ENVFile, *    ) freq</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">57</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, &#x27;(&#x27;&#x27; frequency = &#x27;&#x27;, G11.4, &#x27;&#x27; Hz&#x27;&#x27;, / )&#x27; ) freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">58</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">59</div>
            <div class="execution-count">28</div>
            <div class="source-code">    READ(  ENVFile, * ) NMedia</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">60</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * ) &#x27;Dummy parameter NMedia = &#x27;, NMedia</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">61</div>
            <div class="execution-count">28</div>
            <div class="source-code">    IF ( NMedia /= 1 ) CALL ERROUT( &#x27;READIN&#x27;, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">62</div>
            <div class="execution-count">#####</div>
            <div class="source-code">         &#x27;Only one medium or layer is allowed in BELLHOP; sediment layers must be handled using a reflection coefficient&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">63</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">64</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadTopOpt( Bdry%Top%HS%Opt, Bdry%Top%HS%BC, AttenUnit, FileRoot )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">65</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">66</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! *** Top BC ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">67</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">68</div>
            <div class="execution-count">28</div>
            <div class="source-code">    IF ( Bdry%Top%HS%BC == &#x27;A&#x27; ) THEN</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">69</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, &quot;( //, &#x27;      z         alphaR      betaR     rho        alphaI     betaI&#x27;, / )&quot; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">70</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, &quot;(     &#x27;     (m)         (m/s)      (m/s)   (g/cm^3)      (m/s)     (m/s)&#x27;, / )&quot; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">71</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">72</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">73</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL TopBot( freq, AttenUnit, Bdry%Top%HS )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">74</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">75</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! ****** Read in ocean SSP data ******</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">76</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">77</div>
            <div class="execution-count">28</div>
            <div class="source-code">    READ(  ENVFile, * ) NPts, Sigma, Bdry%Bot%HS%Depth</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">78</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">79</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, FMT = &quot;( &#x27; Depth = &#x27;, F10.2, &#x27; m&#x27; )&quot; ) Bdry%Bot%HS%Depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">80</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">81</div>
            <div class="execution-count">28</div>
            <div class="source-code">    IF ( Bdry%Top%HS%Opt( 1 : 1 ) == &#x27;A&#x27; ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">82</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Analytic SSP option&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">83</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! following is hokey, should be set in Analytic routine</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">84</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%NPts = 2</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">85</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%z( 1 ) = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">86</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SSP%z( 2 ) = Bdry%Bot%HS%Depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">87</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">88</div>
            <div class="execution-count">84</div>
            <div class="source-code">       x = [ 0.0D0, Bdry%Bot%HS%Depth ]   ! tells SSP Depth to read to</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">89</div>
            <div class="execution-count">28</div>
            <div class="source-code">       t = [ 0.0, 1.0 ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">90</div>
            <div class="execution-count">28</div>
            <div class="source-code">       CALL EvaluateSSP( x, t, c, cimag, gradc, crr, crz, czz, rho, freq, &#x27;INI&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">91</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">92</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">93</div>
            <div class="execution-count">28</div>
            <div class="source-code">    Bdry%Top%HS%Depth = SSP%z( 1 )   ! Depth of top boundary is taken from first SSP point</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">94</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! bottom depth should perhaps be set the same way?</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">95</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">96</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! *** Bottom BC ***</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">97</div>
            <div class="execution-count">28</div>
            <div class="source-code">    Bdry%Bot%HS%Opt = &#x27;  &#x27;   ! initialize to blanks</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">98</div>
            <div class="execution-count">28</div>
            <div class="source-code">    READ(  ENVFile, * ) Bdry%Bot%HS%Opt, Sigma</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">99</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">100</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, FMT = &quot;(33X, &#x27;( RMS roughness = &#x27;, G10.3, &#x27; )&#x27; )&quot; ) Sigma</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">101</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">102</div>
            <div class="execution-count">4</div>
            <div class="source-code">    SELECT CASE ( Bdry%Bot%HS%Opt( 2 : 2 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">103</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;~&#x27;, &#x27;*&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">104</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Bathymetry file selected&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">105</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE( &#x27;-&#x27;, &#x27;_&#x27;, &#x27; &#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">106</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">107</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown bottom option letter in second position&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">108</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">109</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">110</div>
            <div class="execution-count">28</div>
            <div class="source-code">    Bdry%Bot%HS%BC = Bdry%Bot%HS%Opt( 1 : 1 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">111</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL TopBot( freq, AttenUnit, Bdry%Bot%HS )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">112</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">113</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! *** source and receiver locations ***</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">114</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">115</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadSxSy( ThreeD )     ! Read source/receiver x-y coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">116</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">117</div>
            <div class="execution-count">28</div>
            <div class="source-code">    ZMin = SNGL( Bdry%Top%HS%Depth )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">118</div>
            <div class="execution-count">28</div>
            <div class="source-code">    ZMax = SNGL( Bdry%Bot%HS%Depth )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">119</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! CALL ReadSzRz( ZMin + 100 * SPACING( ZMin ), ZMax - 100 * SPACING( ZMax ) )   ! not sure why I had this</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">120</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadSzRz( ZMin, ZMax )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">121</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadRcvrRanges</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">122</div>
            <div class="execution-count">28*</div>
            <div class="source-code">    IF ( ThreeD ) CALL ReadRcvrBearings</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">123</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadfreqVec( freq,  Bdry%Top%HS%Opt( 6:6 ) )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">124</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadRunType( Beam%RunType, PlotType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">125</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">126</div>
            <div class="execution-count">28</div>
            <div class="source-code">    Depth = Zmax - Zmin   ! water depth</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">127</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ReadRayElevationAngles( freq, Depth, Bdry%Top%HS%Opt, Beam%RunType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">128</div>
            <div class="execution-count">28*</div>
            <div class="source-code">    IF ( ThreeD ) CALL ReadRayBearingAngles(   freq, Bdry%Top%HS%Opt, Beam%RunType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">129</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">130</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">131</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * ) &#x27;__________________________________________________________________________&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">132</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">133</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">134</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Limits for tracing beams</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">135</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">136</div>
            <div class="execution-count">28</div>
            <div class="source-code">    IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">137</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ(  ENVFile, * ) Beam%deltas, Beam%Box%x, Beam%Box%y, Beam%Box%z</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">138</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Beam%Box%x = 1000.0 * Beam%Box%x   ! convert km to m</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">139</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Beam%Box%y = 1000.0 * Beam%Box%y   ! convert km to m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">140</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">141</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( Beam%deltas == 0.0 ) Beam%deltas = ( Bdry%Bot%HS%Depth - Bdry%Top%HS%Depth ) / 10.0   ! Automatic step size selection</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">142</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! WRITE( PRTFile, &#x27;(&#x27;&#x27; frequency = &#x27;&#x27;, G11.4, &#x27;&#x27; Hz&#x27;&#x27;, / )&#x27; ) freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">143</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">144</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">145</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Step length,       deltas = &#x27;&#x27;, G11.4, &#x27;&#x27; m&#x27;&#x27; )&#x27; ) Beam%deltas</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">146</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">147</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Maximum ray x-range, Box%x = &#x27;&#x27;, G11.4, &#x27;&#x27; m&#x27;&#x27; )&#x27; ) Beam%Box%x</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">148</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Maximum ray y-range, Box%y = &#x27;&#x27;, G11.4, &#x27;&#x27; m&#x27;&#x27; )&#x27; ) Beam%Box%y</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">149</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Maximum ray z-range, Box%z = &#x27;&#x27;, G11.4, &#x27;&#x27; m&#x27;&#x27; )&#x27; ) Beam%Box%z</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">150</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">151</div>
            <div class="execution-count">28</div>
            <div class="source-code">       READ(  ENVFile, * ) Beam%deltas, Beam%Box%z, Beam%Box%r</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">152</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">153</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">154</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Step length,       deltas = &#x27;&#x27;, G11.4, &#x27;&#x27; m&#x27;&#x27; )&#x27; ) Beam%deltas</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">155</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">156</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Maximum ray depth, Box%z  = &#x27;&#x27;, G11.4, &#x27;&#x27; m&#x27;&#x27; )&#x27; ) Beam%Box%z</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">157</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, fmt = &#x27;(  &#x27;&#x27; Maximum ray range, Box%r  = &#x27;&#x27;, G11.4, &#x27;&#x27;km&#x27;&#x27; )&#x27; ) Beam%Box%r</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">158</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">159</div>
            <div class="execution-count">28</div>
            <div class="source-code">       Beam%Box%r = 1000.0 * Beam%Box%r   ! convert km to m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">160</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">161</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">162</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! *** Beam characteristics ***</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">163</div>
            <div class="execution-count">28</div>
            <div class="source-code">    Beam%Type( 4 : 4 ) = Beam%RunType( 7 : 7 )   ! selects beam shift option</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">164</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">165</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( Beam%Type( 4 : 4 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">166</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;S&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">167</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Beam shift in effect&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">168</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">169</div>
            <div class="execution-count">28</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;No beam shift in effect&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">170</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">171</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">172</div>
            <div class="execution-count">28</div>
            <div class="source-code">    IF ( Beam%RunType( 1 : 1 ) /= &#x27;R&#x27; ) THEN   ! no worry about the beam type if this is a ray trace run</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">173</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">174</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Beam%Type( 1 : 1 ) is</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">175</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;G&#x27; or &#x27;^&#x27; Geometric hat beams in Cartesian coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">176</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;g&#x27; Geometric hat beams in ray-centered coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">177</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;B&#x27; Geometric Gaussian beams in Cartesian coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">178</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;b&#x27; Geometric Gaussian beams in ray-centered coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">179</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;S&#x27; Simple Gaussian beams</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">180</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;C&#x27; Cerveny Gaussian beams in Cartesian coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">181</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;R&#x27; Cerveny Gaussian beams in Ray-centered coordinates</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">182</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Beam%Type( 2 : 2 ) controls the setting of the beam width</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">183</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;F&#x27; space Filling</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">184</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;M&#x27; minimum width</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">185</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;W&#x27; WKB beams</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">186</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Beam%Type( 3 : 3 ) controls curvature changes on boundary reflections</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">187</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;D&#x27; Double</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">188</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;S&#x27; Single</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">189</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;Z&#x27; Zero</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">190</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Beam%Type( 4 : 4 ) selects whether beam shifts are implemented on boundary reflection</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">191</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;S&#x27; yes</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">192</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !   &#x27;N&#x27; no</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">193</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">194</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Curvature change can cause overflow in grazing case</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">195</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! Suppress by setting BeamType( 3 : 3 ) = &#x27;Z&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">196</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">197</div>
            <div class="execution-count">25</div>
            <div class="source-code">       Beam%Type( 1 : 1 ) = Beam%RunType( 2 : 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">198</div>
            <div class="execution-count">25*</div>
            <div class="source-code">       SELECT CASE ( Beam%Type( 1 : 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">199</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;G&#x27;, &#x27;g&#x27; , &#x27;^&#x27;, &#x27;B&#x27;, &#x27;b&#x27;, &#x27;S&#x27; )   ! geometric hat beams, geometric Gaussian beams, or simple Gaussian beams</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">200</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;R&#x27;, &#x27;C&#x27; )   ! Cerveny Gaussian Beams; read extra lines to specify the beam options</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">201</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          READ(  ENVFile, * ) Beam%Type( 2 : 3 ), Beam%epsMultiplier, Beam%rLoop</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">202</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">203</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">204</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Type of beam = &#x27;, Beam%Type( 1 : 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">205</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">206</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          SELECT CASE ( Beam%Type( 3 : 3 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">207</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;D&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">208</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             WRITE( PRTFile, * ) &#x27;Curvature doubling invoked&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">209</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;Z&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">210</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             WRITE( PRTFile, * ) &#x27;Curvature zeroing invoked&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">211</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;S&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">212</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             WRITE( PRTFile, * ) &#x27;Standard curvature condition&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">213</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE DEFAULT</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">214</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown curvature condition&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">215</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">216</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">217</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Epsilon multiplier&#x27;, Beam%epsMultiplier</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">218</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Range for choosing beam width&#x27;, Beam%rLoop</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">219</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">220</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ! Images, windows</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">221</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ! LP: These values are not initialized if not written in the file,</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">222</div>
            <div class="execution-count">-</div>
            <div class="source-code">          ! and Component is not always written in the test env files.</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">223</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Beam%Nimage = 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">224</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Beam%iBeamWindow = 4</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">225</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Beam%Component = &#x27;P&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">226</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          READ(  ENVFile, * ) Beam%Nimage, Beam%iBeamWindow, Beam%Component</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">227</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">228</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Number of images, Nimage  = &#x27;, Beam%Nimage</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">229</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Beam windowing parameter  = &#x27;, Beam%iBeamWindow</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">230</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Component                 = &#x27;, Beam%Component</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">231</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">232</div>
            <div class="execution-count">25*</div>
            <div class="source-code">          CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown beam type (second letter of run type)&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">233</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">234</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">235</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">236</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">237</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CLOSE( ENVFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">238</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">239</div>
            <div class="execution-count">28</div>
            <div class="source-code">  END SUBROUTINE ReadEnvironment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">240</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">241</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">242</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">243</div>
            <div class="execution-count">28*</div>
            <div class="source-code">  SUBROUTINE ReadTopOpt( TopOpt, BC, AttenUnit, FileRoot )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">244</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">245</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 6), INTENT( OUT ) :: TopOpt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">246</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 1), INTENT( OUT ) :: BC                     ! Boundary condition type</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">247</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 2), INTENT( OUT ) :: AttenUnit</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">248</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=80), INTENT( IN  ) :: FileRoot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">249</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER            :: iostat</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">250</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">251</div>
            <div class="execution-count">28</div>
            <div class="source-code">    TopOpt = &#x27;      &#x27;   ! initialize to blanks</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">252</div>
            <div class="execution-count">28</div>
            <div class="source-code">    READ(  ENVFile, * ) TopOpt</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">253</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">254</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">255</div>
            <div class="execution-count">28</div>
            <div class="source-code">    SSP%Type  = TopOpt( 1 : 1 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">256</div>
            <div class="execution-count">28</div>
            <div class="source-code">    BC        = TopOpt( 2 : 2 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">257</div>
            <div class="execution-count">28</div>
            <div class="source-code">    AttenUnit = TopOpt( 3 : 4 )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">258</div>
            <div class="execution-count">28</div>
            <div class="source-code">    SSP%AttenUnit = AttenUnit</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">259</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">260</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! SSP approximation options</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">261</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">262</div>
            <div class="execution-count">1</div>
            <div class="source-code">    SELECT CASE ( SSP%Type )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">263</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;N&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">264</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    N2-linear approximation to SSP&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">265</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;C&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">266</div>
            <div class="execution-count">2*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    C-linear approximation to SSP&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">267</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;P&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">268</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    PCHIP approximation to SSP&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">269</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;S&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">270</div>
            <div class="execution-count">24</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Spline approximation to SSP&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">271</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;Q&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">272</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Quad approximation to SSP&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">273</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       OPEN ( FILE = TRIM( FileRoot ) // &#x27;.ssp&#x27;, UNIT = SSPFile, FORM = &#x27;FORMATTED&#x27;, STATUS = &#x27;OLD&#x27;, IOSTAT = iostat )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">274</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       IF ( IOSTAT /= 0 ) THEN   ! successful open?</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">275</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;SSPFile = &#x27;, TRIM( FileRoot ) // &#x27;.ssp&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">276</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;BELLHOP - READIN&#x27;, &#x27;Unable to open the SSP file&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">277</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">278</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;H&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">279</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Hexahedral approximation to SSP&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">280</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       OPEN ( FILE = TRIM( FileRoot ) // &#x27;.ssp&#x27;, UNIT = SSPFile, FORM = &#x27;FORMATTED&#x27;, STATUS = &#x27;OLD&#x27;, IOSTAT = iostat )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">281</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( IOSTAT /= 0 ) THEN   ! successful open?</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">282</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;SSPFile = &#x27;, TRIM( FileRoot ) // &#x27;.ssp&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">283</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;BELLHOP - READIN&#x27;, &#x27;Unable to open the SSP file&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">284</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">285</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">286</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Analytic SSP option&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">287</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">288</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown option for SSP approximation&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">289</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">290</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">291</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Attenuation options</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">292</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">293</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( AttenUnit( 1 : 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">294</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;N&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">295</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Attenuation units: nepers/m&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">296</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;F&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">297</div>
            <div class="execution-count">26*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Attenuation units: dB/mkHz&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">298</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;M&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">299</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Attenuation units: dB/m&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">300</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;W&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">301</div>
            <div class="execution-count">2*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Attenuation units: dB/wavelength&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">302</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;Q&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">303</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Attenuation units: Q&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">304</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;L&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">305</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Attenuation units: Loss parameter&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">306</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">307</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown attenuation units&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">308</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">309</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">310</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! optional addition of volume attenuation using standard formulas</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">311</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">312</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( AttenUnit( 2 : 2 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">313</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;T&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">314</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    THORP volume attenuation added&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">315</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;F&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">316</div>
            <div class="execution-count">2</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Francois-Garrison volume attenuation added&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">317</div>
            <div class="execution-count">2</div>
            <div class="source-code">       READ(  ENVFile, * ) T, Salinity, pH, z_bar</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">318</div>
            <div class="execution-count">-</div>
            <div class="source-code">       WRITE( PRTFile, &quot;( &#x27; T = &#x27;, G11.4, &#x27;degrees   S = &#x27;, G11.4, &#x27; psu   pH = &#x27;, G11.4, &#x27; z_bar = &#x27;, G11.4, &#x27; m&#x27; )&quot; ) &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">319</div>
            <div class="execution-count">2*</div>
            <div class="source-code">            T, Salinity, pH, z_bar</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">320</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;B&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">321</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Biological attenaution&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">322</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ( ENVFile, *  ) NBioLayers</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">323</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;      Number of Bio Layers = &#x27;, NBioLayers</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">324</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">325</div>
            <div class="execution-count">26*</div>
            <div class="source-code">       DO iBio = 1, NBioLayers</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">326</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          READ( ENVFile, *  ) bio( iBio )%Z1, bio( iBio )%Z2, bio( iBio )%f0, bio( iBio )%Q, bio( iBio )%a0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">327</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;      Top    of layer = &#x27;, bio( iBio )%Z1, &#x27; m&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">328</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;      Bottom of layer = &#x27;, bio( iBio )%Z2, &#x27; m&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">329</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;      Resonance frequency = &#x27;, bio( iBio )%f0, &#x27; Hz&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">330</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;      Q  = &#x27;, bio( iBio )%Q</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">331</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;      a0 = &#x27;, bio( iBio )%a0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">332</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">333</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27; &#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">334</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">335</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown top option letter in fourth position&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">336</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">337</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">338</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( TopOpt( 5 : 5 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">339</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;~&#x27;, &#x27;*&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">340</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Altimetry file selected&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">341</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;-&#x27;, &#x27;_&#x27;, &#x27; &#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">342</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">343</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown top option letter in fifth position&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">344</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">345</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">346</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( TopOpt( 6 : 6 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">347</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;I&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">348</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Development options enabled&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">349</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27; &#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">350</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">351</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown top option letter in sixth position&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">352</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">353</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">354</div>
            <div class="execution-count">28</div>
            <div class="source-code">  END SUBROUTINE ReadTopOpt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">355</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">356</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">357</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">358</div>
            <div class="execution-count">28*</div>
            <div class="source-code">  SUBROUTINE ReadRunType( RunType, PlotType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">359</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Reads and validates the run type parameters</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">360</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">361</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Read the RunType variable and echo with explanatory information to the print file</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">362</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">363</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE SourceReceiverPositions</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">364</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">365</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 7), INTENT( OUT ) :: RunType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">366</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=10), INTENT( OUT ) :: PlotType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">367</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">368</div>
            <div class="execution-count">28</div>
            <div class="source-code">    READ(  ENVFile, * ) RunType</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">369</div>
            <div class="execution-count">28</div>
            <div class="source-code">    WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">370</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">371</div>
            <div class="execution-count">3</div>
            <div class="source-code">    SELECT CASE ( RunType( 1 : 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">372</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;R&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">373</div>
            <div class="execution-count">3</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Ray trace run&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">374</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;E&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">375</div>
            <div class="execution-count">5*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Eigenray trace run&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">376</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;I&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">377</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Incoherent TL calculation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">378</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;S&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">379</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Semi-coherent TL calculation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">380</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;C&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">381</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Coherent TL calculation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">382</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">383</div>
            <div class="execution-count">12*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Arrivals calculation, ASCII  file output&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">384</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;a&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">385</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Arrivals calculation, binary file output&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">386</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">387</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       CALL ERROUT( &#x27;READIN&#x27;, &#x27;Unknown RunType selected&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">388</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">389</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">390</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( RunType( 2 : 2 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">391</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;C&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">392</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Cartesian beams&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">393</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;R&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">394</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Ray centered beams&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">395</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;S&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">396</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Simple gaussian beams&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">397</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;b&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">398</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Geometric gaussian beams in ray-centered coordinates&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">399</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;B&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">400</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Geometric gaussian beams in Cartesian coordinates&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">401</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;g&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">402</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Geometric hat beams in ray-centered coordinates&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">403</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">404</div>
            <div class="execution-count">27</div>
            <div class="source-code">       RunType( 2 : 2 ) = &#x27;G&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">405</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Geometric hat beams in Cartesian coordinates&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">406</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">407</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">408</div>
            <div class="execution-count">1</div>
            <div class="source-code">    SELECT CASE ( RunType( 4 : 4 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">409</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;R&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">410</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Point source (cylindrical coordinates)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">411</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;X&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">412</div>
            <div class="execution-count">1</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Line source (Cartesian coordinates)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">413</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">414</div>
            <div class="execution-count">26</div>
            <div class="source-code">       RunType( 4 : 4 ) = &#x27;R&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">415</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Point source (cylindrical coordinates)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">416</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">417</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">418</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( RunType( 5 : 5 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">419</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;R&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">420</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Rectilinear receiver grid: Receivers at ( Rr( ir ), Rz( ir ) ) )&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">421</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       PlotType = &#x27;rectilin  &#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">422</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;I&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">423</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Irregular grid: Receivers at Rr( : ) x Rz( : )&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">424</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( Pos%NRz /= Pos%NRr ) CALL ERROUT( &#x27;READIN&#x27;, &#x27;Irregular grid option selected with NRz not equal to Nr&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">425</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       PlotType = &#x27;irregular &#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">426</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">427</div>
            <div class="execution-count">28</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Rectilinear receiver grid: Receivers at Rr( : ) x Rz( : )&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">428</div>
            <div class="execution-count">28</div>
            <div class="source-code">       RunType( 5 : 5 ) = &#x27;R&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">429</div>
            <div class="execution-count">56</div>
            <div class="source-code">       PlotType = &#x27;rectilin  &#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">430</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">431</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">432</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( RunType( 6 : 6 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">433</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;2&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">434</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;N x 2D calculation (neglects horizontal refraction)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">435</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;3&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">436</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;3D calculation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">437</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">438</div>
            <div class="execution-count">28</div>
            <div class="source-code">       RunType( 6 : 6 ) = &#x27;2&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">439</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">440</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">441</div>
            <div class="execution-count">28</div>
            <div class="source-code">  END SUBROUTINE ReadRunType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">442</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">443</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">444</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">445</div>
            <div class="execution-count">56*</div>
            <div class="source-code">  SUBROUTINE TopBot( freq, AttenUnit, HS )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">446</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Handles top and bottom boundary conditions</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">447</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">448</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8), INTENT( IN    ) :: freq     ! center / nominal frequency (wideband not supported)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">449</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=2), INTENT( IN    ) :: AttenUnit</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">450</div>
            <div class="execution-count">-</div>
            <div class="source-code">    TYPE( HSInfo ),    INTENT( INOUT ) :: HS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">451</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL     (KIND=8) :: Mz, vr, alpha2_f          ! values related to grain size</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">452</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">453</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Echo to PRTFile user&#x27;s choice of boundary condition</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">454</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">455</div>
            <div class="execution-count">27</div>
            <div class="source-code">    SELECT CASE ( HS%BC )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">456</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;V&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">457</div>
            <div class="execution-count">27*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    VACUUM&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">458</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;R&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">459</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Perfectly RIGID&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">460</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">461</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    ACOUSTO-ELASTIC half-space&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">462</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;G&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">463</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Grain size to define half-space&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">464</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;F&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">465</div>
            <div class="execution-count">1*</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    FILE used for reflection loss&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">466</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;W&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">467</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    Writing an IRC file&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">468</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;P&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">469</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;    reading PRECALCULATED IRC&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">470</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">471</div>
            <div class="execution-count">56*</div>
            <div class="source-code">       CALL ERROUT( &#x27;TopBot&#x27;, &#x27;Unknown boundary condition type&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">472</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">473</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">474</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! ****** Read in BC parameters depending on particular choice ******</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">475</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">476</div>
            <div class="execution-count">56</div>
            <div class="source-code">    HS%cp  = 0.0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">477</div>
            <div class="execution-count">56</div>
            <div class="source-code">    HS%cs  = 0.0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">478</div>
            <div class="execution-count">56</div>
            <div class="source-code">    HS%rho = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">479</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">480</div>
            <div class="execution-count">28</div>
            <div class="source-code">    SELECT CASE ( HS%BC )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">481</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )                  ! *** Half-space properties ***</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">482</div>
            <div class="execution-count">28</div>
            <div class="source-code">       zTemp = 0.0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">483</div>
            <div class="execution-count">28</div>
            <div class="source-code">       READ(  ENVFile, *    ) zTemp, alphaR, betaR, rhoR, alphaI, betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">484</div>
            <div class="execution-count">-</div>
            <div class="source-code">       WRITE( PRTFile, FMT = &quot;( F10.2, 3X, 2F10.2, 3X, F6.2, 3X, 2F10.4 )&quot; ) &amp;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">485</div>
            <div class="execution-count">28</div>
            <div class="source-code">            zTemp, alphaR, betaR, rhoR, alphaI, betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">486</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">487</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! dummy parameters for a layer with a general power law for attenuation</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">488</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! these are not in play because the AttenUnit for this is not allowed yet</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">489</div>
            <div class="execution-count">-</div>
            <div class="source-code">       !freq0         = freq</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">490</div>
            <div class="execution-count">28</div>
            <div class="source-code">       betaPowerLaw  = 1.0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">491</div>
            <div class="execution-count">28</div>
            <div class="source-code">       ft            = 1000.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">492</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">493</div>
            <div class="execution-count">28</div>
            <div class="source-code">       HS%cp  = CRCI( zTemp, alphaR, alphaI, freq, freq, AttenUnit, betaPowerLaw, ft )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">494</div>
            <div class="execution-count">28</div>
            <div class="source-code">       HS%cs  = CRCI( zTemp, betaR,  betaI,  freq, freq, AttenUnit, betaPowerLaw, ft )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">495</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">496</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       HS%rho = rhoR</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">497</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;G&#x27; )                  ! *** Grain size (formulas from UW-APL HF Handbook)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">498</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">499</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! These formulas are from the UW-APL Handbook</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">500</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! The code is taken from older Matlab and is unnecesarily verbose</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">501</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! vr   is the sound speed ratio</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">502</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! rhor is the density ratio</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">503</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ(  ENVFile, *    ) zTemp, Mz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">504</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, FMT = &quot;( F10.2, 3X, F10.2 )&quot; ) zTemp, Mz</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">505</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">506</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( Mz &gt;= -1 .AND. Mz &lt; 1 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">507</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          vr   = 0.002709 * Mz ** 2 - 0.056452 * Mz + 1.2778</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">508</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          rhor = 0.007797 * Mz ** 2 - 0.17057  * Mz + 2.3139</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">509</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ELSE IF ( Mz &gt;= 1 .AND. Mz &lt; 5.3 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">510</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          vr   = -0.0014881 * Mz ** 3 + 0.0213937 * Mz ** 2 - 0.1382798 * Mz + 1.3425</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">511</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          rhor = -0.0165406 * Mz ** 3 + 0.2290201 * Mz ** 2 - 1.1069031 * Mz + 3.0455</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">512</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">513</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          vr   = -0.0024324 * Mz + 1.0019</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">514</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          rhor = -0.0012973 * Mz + 1.1565</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">515</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">516</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">517</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( Mz &gt;= -1 .AND. Mz &lt; 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">518</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          alpha2_f = 0.4556</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">519</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ELSE IF ( Mz &gt;= 0 .AND. Mz &lt; 2.6 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">520</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          alpha2_f = 0.4556 + 0.0245 * Mz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">521</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ELSE IF( Mz &gt;= 2.6 .AND. Mz &lt; 4.5 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">522</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          alpha2_f = 0.1978 + 0.1245 * Mz</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">523</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ELSE IF( Mz &gt;= 4.5 .AND. Mz &lt; 6.0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">524</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          alpha2_f = 8.0399 - 2.5228 * Mz + 0.20098 * Mz ** 2</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">525</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ELSE IF( Mz &gt;= 6.0 .AND. Mz &lt; 9.5 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">526</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          alpha2_f = 0.9431 - 0.2041 * Mz + 0.0117 * Mz ** 2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">527</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">528</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          alpha2_f =  0.0601</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">529</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">530</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">531</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! AttenUnit = &#x27;L&#x27;   ! loss parameter</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">532</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!! following uses a reference sound speed of 1500 ???</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">533</div>
            <div class="execution-count">-</div>
            <div class="source-code">!!! should be sound speed in the water, just above the sediment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">534</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! the term vr / 1000 converts vr to units of m per ms</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">535</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       alphaR = vr * 1500.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">536</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       alphaI = alpha2_f * ( vr / 1000 ) * 1500.0 * log( 10.0 ) / ( 40.0 * pi )   ! loss parameter Sect. IV., Eq. (4) of handbook</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">537</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">538</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       HS%cp  = CRCI( zTemp, alphaR, alphaI, freq, freq, &#x27;L &#x27;, betaPowerLaw, ft )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">539</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       HS%cs  = 0.0</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">540</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       HS%rho = rhoR</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">541</div>
            <div class="execution-count">-</div>
            <div class="source-code">       WRITE( PRTFile, FMT = &quot;( &#x27;Converted sound speed =&#x27;, 2F10.2, 3X, &#x27;density = &#x27;, F10.2, 3X, &#x27;loss parm = &#x27;, F10.4 )&quot; ) &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">542</div>
            <div class="execution-count">56*</div>
            <div class="source-code">            HS%cp, rhor, alphaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">543</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">544</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">545</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">546</div>
            <div class="execution-count">56</div>
            <div class="source-code">  END SUBROUTINE TopBot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">547</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">548</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">549</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">550</div>
            <div class="execution-count">28*</div>
            <div class="source-code">  SUBROUTINE OpenOutputFiles( FileRoot, ThreeD )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">551</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !! Opens output files based on run type</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">552</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">553</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Write appropriate header information</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">554</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">555</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE SourceReceiverPositions</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">556</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE angleMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">557</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE bdryMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">558</div>
            <div class="execution-count">-</div>
            <div class="source-code">    USE RWSHDFile</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">559</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">560</div>
            <div class="execution-count">-</div>
            <div class="source-code">    LOGICAL,            INTENT( IN ) :: ThreeD</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">561</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=80), INTENT( IN ) :: FileRoot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">562</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL               :: atten</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">563</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=10) :: PlotType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">564</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">565</div>
            <div class="execution-count">8</div>
            <div class="source-code">    SELECT CASE ( Beam%RunType( 1 : 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">566</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;R&#x27;, &#x27;E&#x27; )   ! Ray trace or Eigenrays</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">567</div>
            <div class="execution-count">8*</div>
            <div class="source-code">       OPEN ( FILE = TRIM( FileRoot ) // &#x27;.ray&#x27;, UNIT = RAYFile, FORM = &#x27;FORMATTED&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">568</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( RAYFile, * ) &#x27;&#x27;&#x27;&#x27;, Title( 1 : 50 ), &#x27;&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">569</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( RAYFile, * ) freq</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">570</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( RAYFile, * ) Pos%NSx, Pos%NSy, Pos%NSz</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">571</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( RAYFile, * ) Angles%Nalpha, Angles%Nbeta</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">572</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( RAYFile, * ) Bdry%Top%HS%Depth</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">573</div>
            <div class="execution-count">8</div>
            <div class="source-code">       WRITE( RAYFile, * ) Bdry%Bot%HS%Depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">574</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">575</div>
            <div class="execution-count">16</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">576</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( RAYFile, * ) &#x27;&#x27;&#x27;xyz&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">577</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">578</div>
            <div class="execution-count">8</div>
            <div class="source-code">          WRITE( RAYFile, * ) &#x27;&#x27;&#x27;rz&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">579</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">580</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">581</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;A&#x27; )        ! arrival file in ascii format</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">582</div>
            <div class="execution-count">12*</div>
            <div class="source-code">       OPEN ( FILE = TRIM( FileRoot ) // &#x27;.arr&#x27;, UNIT = ARRFile, FORM = &#x27;FORMATTED&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">583</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">584</div>
            <div class="execution-count">12</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">585</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile, * ) &#x27;&#x27;&#x27;3D&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">586</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">587</div>
            <div class="execution-count">12</div>
            <div class="source-code">          WRITE( ARRFile, * ) &#x27;&#x27;&#x27;2D&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">588</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">589</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">590</div>
            <div class="execution-count">12</div>
            <div class="source-code">       WRITE( ARRFile, * ) freq</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">591</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">592</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! write source locations</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">593</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">594</div>
            <div class="execution-count">12</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">595</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile, * ) Pos%NSx,    Pos%Sx(    1 : Pos%NSx )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">596</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile, * ) Pos%NSy,    Pos%Sy(    1 : Pos%NSy )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">597</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile, * ) Pos%NSz,    Pos%Sz(    1 : Pos%NSz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">598</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">599</div>
            <div class="execution-count">12*</div>
            <div class="source-code">          WRITE( ARRFile, * ) Pos%NSz,    Pos%Sz(    1 : Pos%NSz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">600</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">601</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">602</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! write receiver locations</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">603</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">604</div>
            <div class="execution-count">12*</div>
            <div class="source-code">       WRITE( ARRFile, *    ) Pos%NRz,    Pos%Rz(    1 : Pos%NRz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">605</div>
            <div class="execution-count">12*</div>
            <div class="source-code">       WRITE( ARRFile, *    ) Pos%NRr,    Pos%Rr(    1 : Pos%NRr )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">606</div>
            <div class="execution-count">12*</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">607</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile, * ) Pos%Ntheta, Pos%theta( 1 : Pos%Ntheta )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">608</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">609</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">610</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;a&#x27; )        ! arrival file in binary format</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">611</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       OPEN ( FILE = TRIM( FileRoot ) // &#x27;.arr&#x27;, UNIT = ARRFile, FORM = &#x27;UNFORMATTED&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">612</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">613</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">614</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile ) &#x27;&#x27;&#x27;3D&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">615</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">616</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile ) &#x27;&#x27;&#x27;2D&#x27;&#x27;&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">617</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">618</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">619</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( ARRFile    ) SNGL( freq )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">620</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">621</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! write source locations</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">622</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">623</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">624</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile    ) Pos%NSx,    Pos%Sx(    1 : Pos%NSx )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">625</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile    ) Pos%NSy,    Pos%Sy(    1 : Pos%NSy )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">626</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile    ) Pos%NSz,    Pos%Sz(    1 : Pos%NSz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">627</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">628</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile    ) Pos%NSz,    Pos%Sz(    1 : Pos%NSz )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">629</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">630</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">631</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! write receiver locations</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">632</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">633</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( ARRFile       ) Pos%NRz,    Pos%Rz(    1 : Pos%NRz )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">634</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( ARRFile       ) Pos%NRr,    Pos%Rr(    1 : Pos%NRr )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">635</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( ThreeD ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">636</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( ARRFile    ) Pos%Ntheta, Pos%theta( 1 : Pos%Ntheta )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">637</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">638</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">639</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">640</div>
            <div class="execution-count">8</div>
            <div class="source-code">       atten = 0.0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">641</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">642</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! following to set PlotType has already been done in READIN if that was used for input</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">643</div>
            <div class="execution-count">8</div>
            <div class="source-code">       SELECT CASE ( Beam%RunType( 5 : 5 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">644</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;R&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">645</div>
            <div class="execution-count">8*</div>
            <div class="source-code">          PlotType = &#x27;rectilin  &#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">646</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;I&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">647</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          PlotType = &#x27;irregular &#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">648</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">649</div>
            <div class="execution-count">8*</div>
            <div class="source-code">          PlotType = &#x27;rectilin  &#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">650</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">651</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">652</div>
            <div class="execution-count">36*</div>
            <div class="source-code">       CALL WriteHeader( TRIM( FileRoot ) // &#x27;.shd&#x27;, Title, REAL( freq ), atten, PlotType )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">653</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">654</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">655</div>
            <div class="execution-count">28</div>
            <div class="source-code">  END SUBROUTINE OpenOutputFiles</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">656</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">657</div>
            <div class="execution-count">-</div>
            <div class="source-code">END MODULE ReadEnvironmentBell</div>
        </div>
    </div>

    <div class="footer">
        <p><strong>Legend:</strong></p>
        <ul>
            <li><span style="background-color: #d4edda; padding: 2px 4px;">Green</span> - Executed lines</li>
            <li><span style="background-color: #f8d7da; padding: 2px 4px;">Red</span> - Not executed lines</li>
            <li><span style="background-color: #f8f9fa; padding: 2px 4px;">Gray</span> - Non-executable lines (comments, declarations)</li>
        </ul>
        <p><strong>Execution Count:</strong> Number of times each line was executed. ##### indicates never executed, - indicates non-executable.</p>
    </div>
</body>
</html>