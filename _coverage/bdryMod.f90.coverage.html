<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coverage Report: bdryMod.f90</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .metric {
            background-color: #ecf0f1;
            padding: 10px;
            border-radius: 3px;
            text-align: center;
            min-width: 120px;
        }
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
        }
        .code-container {
            background-color: white;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            overflow: auto;
        }
        .code-line {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
        }
        .line-number {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 60px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #6c757d;
        }
        .execution-count {
            background-color: #f8f9fa;
            padding: 2px 8px;
            width: 80px;
            text-align: right;
            border-right: 1px solid #dee2e6;
            color: #495057;
        }
        .source-code {
            padding: 2px 8px;
            flex: 1;
            white-space: pre;
        }
        .executed { background-color: #d4edda; }
        .not-executed { background-color: #f8d7da; }
        .non-executable { background-color: #f8f9fa; }
        .footer {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            font-size: 0.9em;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Coverage Report: bdryMod.f90</h1>
        <p>Generated from GCOV analysis of Fortran source code</p>
    </div>

    <div class="summary">
        <div class="metric">
            <div class="metric-value">50.3%</div>
            <div>Lines Executed</div>
            <div>169 total lines</div>
        </div>
        <div class="metric">
            <div class="metric-value">56.5%</div>
            <div>Branches Executed</div>
            <div>423 total branches</div>
        </div>
        <div class="metric">
            <div class="metric-value">100.0%</div>
            <div>Calls Executed</div>
            <div>49 total calls</div>
        </div>
    </div>

    <div class="code-container">
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Source:bdryMod.f90</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Graph:bdryMod.gcno</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Data:bdryMod.gcda</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">0</div>
            <div class="execution-count">-</div>
            <div class="source-code">Runs:57</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">1</div>
            <div class="execution-count">-</div>
            <div class="source-code">!! Boundary conditions module for altimetry and bathymetry data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">2</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">3</div>
            <div class="execution-count">-</div>
            <div class="source-code">MODULE bdrymod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">4</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Boundary handling for altimetry (top) and bathymetry (bottom) with interpolation capabilities</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">5</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">6</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Loads altimetry (top bdry) and bathymetry (bottom bdry) data</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">7</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">8</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !USE norms</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">9</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE monotonicMod</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">10</div>
            <div class="execution-count">-</div>
            <div class="source-code">  USE FatalError</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">11</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">12</div>
            <div class="execution-count">-</div>
            <div class="source-code">  IMPLICIT NONE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">13</div>
            <div class="execution-count">-</div>
            <div class="source-code">  PUBLIC</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">14</div>
            <div class="execution-count">-</div>
            <div class="source-code">  SAVE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">15</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">16</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER, PARAMETER :: ATIFile = 40, BTYFile = 41, Number_to_Echo = 21</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">17</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER            :: IsegTop, IsegBot                ! indices that point to the current active segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">18</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER, PROTECTED :: NATIPts = 2, NBTYPts = 2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">19</div>
            <div class="execution-count">-</div>
            <div class="source-code">  INTEGER            :: ii, IOStat, IAllocStat, iSmallStepCtr = 0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">20</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">21</div>
            <div class="execution-count">-</div>
            <div class="source-code">  REAL (KIND=8)      :: rTopseg( 2 ), rBotseg( 2 )      ! range intervals defining the current active segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">22</div>
            <div class="execution-count">-</div>
            <div class="source-code">  CHARACTER  (LEN=2) :: atiType= &#x27;LS&#x27;, btyType = &#x27;LS&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">23</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">24</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! Halfspace properties</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">25</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE HSInfo2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">26</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL     (KIND=8) :: alphaR, alphaI, betaR, betaI  ! compressional and shear wave speeds/attenuations in user units</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">27</div>
            <div class="execution-count">-</div>
            <div class="source-code">     COMPLEX  (KIND=8) :: cP, cS                        ! P-wave, S-wave speeds</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">28</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL     (KIND=8) :: rho, Depth                    ! density, depth</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">29</div>
            <div class="execution-count">-</div>
            <div class="source-code">     CHARACTER (LEN=1) :: BC                            ! Boundary condition type</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">30</div>
            <div class="execution-count">-</div>
            <div class="source-code">     CHARACTER (LEN=6) :: Opt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">31</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE HSInfo2</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">32</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">33</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE BdryPt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">34</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL    (KIND=8) :: x( 2 ), t( 2 ), n( 2 )         ! coordinate, tangent, and outward normal for a segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">35</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL    (KIND=8) :: Nodet( 2 ), Noden( 2 )         ! tangent and normal at the node, if the curvilinear option is used</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">36</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL    (KIND=8) :: Len, Kappa                     ! length and curvature of a segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">37</div>
            <div class="execution-count">-</div>
            <div class="source-code">     REAL    (KIND=8) :: Dx, Dxx, Dss                   ! first, second derivatives wrt depth; s is along tangent</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">38</div>
            <div class="execution-count">-</div>
            <div class="source-code">     TYPE( HSInfo2 )  :: HS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">39</div>
            <div class="execution-count">-</div>
            <div class="source-code">  END TYPE BdryPt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">40</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">41</div>
            <div class="execution-count">-</div>
            <div class="source-code">  TYPE(BdryPt), ALLOCATABLE :: Top( : ), Bot( : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">42</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">43</div>
            <div class="execution-count">-</div>
            <div class="source-code">CONTAINS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">44</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">45</div>
            <div class="execution-count">28*</div>
            <div class="source-code">  SUBROUTINE ReadATI( FileRoot, TopATI, DepthT, PRTFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">46</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Reads in the top altimetry</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">47</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">48</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,            INTENT( IN ) :: PRTFile</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">49</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 1), INTENT( IN ) :: TopATI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">50</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN ) :: DepthT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">51</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! REAL      (KIND=8), ALLOCATABLE  :: phi( : ) ! LP: Removed as seems to have been moved to ComputeBdryTangentNormal</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">52</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=80), INTENT( IN ) :: FileRoot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">53</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">54</div>
            <div class="execution-count">#####</div>
            <div class="source-code">    SELECT CASE ( TopATI )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">55</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;~&#x27;, &#x27;*&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">56</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;__________________________________________________________________________&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">57</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">58</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Using top-altimetry file&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">59</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">60</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       OPEN( UNIT = ATIFile,   FILE = TRIM( FileRoot ) // &#x27;.ati&#x27;, STATUS = &#x27;OLD&#x27;, IOSTAT = IOStat, ACTION = &#x27;READ&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">61</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( IOsTAT /= 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">62</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;ATIFile = &#x27;, TRIM( FileRoot ) // &#x27;.ati&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">63</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;ReadATI&#x27;, &#x27;Unable to open altimetry file&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">64</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">65</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">66</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ(  ATIFile, * ) atiType</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">67</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       AltiType: SELECT CASE ( atiType( 1 : 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">68</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;C&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">69</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Curvilinear Interpolation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">70</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;L&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">71</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Piecewise linear interpolation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">72</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE DEFAULT</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">73</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;ReadATI&#x27;, &#x27;Unknown option for selecting altimetry interpolation&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">74</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT AltiType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">75</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">76</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       READ(  ATIFile, * ) NatiPts</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">77</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Number of altimetry points = &#x27;, NatiPts</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">78</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       NatiPts = NatiPts + 2   ! we&#x27;ll be extending the altimetry to infinity to the left and right</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">79</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">80</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( Top( NatiPts ), Stat = IAllocStat )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">81</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! ALLOCATE( phi( NatiPts ), Stat = IAllocStat ) ! LP: Removed as seems to have been moved to ComputeBdryTangentNormal</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">82</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IF ( IAllocStat /= 0 ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">83</div>
            <div class="execution-count">#####</div>
            <div class="source-code">            CALL ERROUT( &#x27;BELLHOP:ReadATI&#x27;, &#x27;Insufficient memory for altimetry data: reduce # ati points&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">84</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">85</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">86</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27; Range (km)  Depth (m)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">87</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">88</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       atiPt: DO ii = 2, NatiPts - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">89</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">90</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          SELECT CASE ( atiType( 2 : 2 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">91</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;S&#x27;, &#x27;&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">92</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             READ(  ATIFile, * ) Top( ii )%x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">93</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! LP: This condition was previously ii == NatiPts,</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">94</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! which will never be satisfied due to the loop bounds</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">95</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             IF ( ii &lt; Number_to_Echo .OR. ii == NatiPts - 1 ) THEN   ! echo some values</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">96</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                WRITE( PRTFile, FMT = &quot;(2G11.3)&quot; ) Top( ii )%x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">97</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">98</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;L&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">99</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             READ(  ATIFile, * )                   Top( ii )%x, Top( ii )%HS%alphaR, Top( ii )%HS%betaR, Top( ii )%HS%rho, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">100</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                                                                Top( ii )%HS%alphaI, Top( ii )%HS%betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">101</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! LP: Same change as above</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">102</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             IF ( ii &lt; Number_to_Echo .OR. ii == NatiPts - 1 ) THEN   ! echo some values</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">103</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                WRITE( PRTFile, FMT = &quot;(7G11.3)&quot; ) Top( ii )%x, Top( ii )%HS%alphaR, Top( ii )%HS%betaR, Top( ii )%HS%rho, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">104</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                                                                Top( ii )%HS%alphaI, Top( ii )%HS%betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">105</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">106</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE DEFAULT</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">107</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             CALL ERROUT( &#x27;ReadATI&#x27;, &#x27;Unknown option for selecting altimetry option&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">108</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">109</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">110</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          IF ( Top( ii )%x( 2 ) &lt; DepthT ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">111</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             CALL ERROUT( &#x27;BELLHOP:ReadATI&#x27;, &#x27;Altimetry rises above highest point in the sound speed profile&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">112</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">113</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO atiPt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">114</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">115</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CLOSE( ATIFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">116</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">117</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Top( : )%x( 1 ) = 1000.0 * Top( : )%x( 1 )   ! Convert ranges in km to m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">118</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">119</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT   ! no altimetry given, use SSP depth for flat top</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">120</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       ALLOCATE( Top( 2 ), Stat = IAllocStat )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">121</div>
            <div class="execution-count">28*</div>
            <div class="source-code">       IF ( IAllocStat /= 0 ) CALL ERROUT( &#x27;BELLHOP&#x27;, &#x27;Insufficient memory for altimetry data&#x27;  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">122</div>
            <div class="execution-count">84*</div>
            <div class="source-code">       Top( 1 )%x = [ -sqrt( huge( Top( 1 )%x( 1 ) ) ) / 1.0d5, DepthT ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">123</div>
            <div class="execution-count">112*</div>
            <div class="source-code">       Top( 2 )%x = [  sqrt( huge( Top( 1 )%x( 1 ) ) ) / 1.0d5, DepthT ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">124</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">125</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">126</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ComputeBdryTangentNormal( Top, &#x27;Top&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">127</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">128</div>
            <div class="execution-count">84*</div>
            <div class="source-code">    IF ( .NOT. monotonic( Top%x( 1 ), NAtiPts ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">129</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ERROUT( &#x27;BELLHOP:ReadATI&#x27;, &#x27;Altimetry ranges are not monotonically increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">130</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">131</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">132</div>
            <div class="execution-count">28</div>
            <div class="source-code">  END SUBROUTINE ReadATI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">133</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">134</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">135</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">136</div>
            <div class="execution-count">28*</div>
            <div class="source-code">  SUBROUTINE ReadBTY( FileRoot, BotBTY, DepthB, PRTFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">137</div>
            <div class="execution-count">-</div>
            <div class="source-code">  !! Reads in the bottom bathymetry</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">138</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">139</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER,            INTENT( IN ) :: PRTFile</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">140</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN= 1), INTENT( IN ) :: BotBTY</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">141</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8), INTENT( IN ) :: DepthB</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">142</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=80), INTENT( IN ) :: FileRoot</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">143</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">144</div>
            <div class="execution-count">4</div>
            <div class="source-code">    SELECT CASE ( BotBTY )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">145</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;~&#x27;, &#x27;*&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">146</div>
            <div class="execution-count">4</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;__________________________________________________________________________&#x27;</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">147</div>
            <div class="execution-count">4</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">148</div>
            <div class="execution-count">4</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Using bottom-bathymetry file&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">149</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">150</div>
            <div class="execution-count">4*</div>
            <div class="source-code">       OPEN( UNIT = BTYFile,   FILE = TRIM( FileRoot ) // &#x27;.bty&#x27;, STATUS = &#x27;OLD&#x27;, IOSTAT = IOStat, ACTION = &#x27;READ&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">151</div>
            <div class="execution-count">4</div>
            <div class="source-code">       IF ( IOsTAT /= 0 ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">152</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;BTYFile = &#x27;, TRIM( FileRoot ) // &#x27;.bty&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">153</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          CALL ERROUT( &#x27;ReadBTY&#x27;, &#x27;Unable to open bathymetry file&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">154</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">155</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">156</div>
            <div class="execution-count">4</div>
            <div class="source-code">       READ( BTYFile, * ) btyType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">157</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">158</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       BathyType: SELECT CASE ( btyType( 1 : 1 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">159</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;C&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">160</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Curvilinear Interpolation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">161</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;L&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">162</div>
            <div class="execution-count">4*</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Piecewise linear interpolation&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">163</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">164</div>
            <div class="execution-count">4*</div>
            <div class="source-code">          CALL ERROUT( &#x27;ReadBTY&#x27;, &#x27;Unknown option for selecting bathymetry interpolation&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">165</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT BathyType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">166</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">167</div>
            <div class="execution-count">4</div>
            <div class="source-code">       READ(  BTYFile, * ) NbtyPts</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">168</div>
            <div class="execution-count">4</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;Number of bathymetry points = &#x27;, NbtyPts</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">169</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">170</div>
            <div class="execution-count">4</div>
            <div class="source-code">       NbtyPts = NbtyPts + 2   ! we&#x27;ll be extending the bathymetry to infinity on both sides</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">171</div>
            <div class="execution-count">4*</div>
            <div class="source-code">       ALLOCATE( Bot( NbtyPts ), Stat = IAllocStat )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">172</div>
            <div class="execution-count">4</div>
            <div class="source-code">       IF ( IAllocStat /= 0 ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">173</div>
            <div class="execution-count">#####</div>
            <div class="source-code">            CALL ERROUT( &#x27;BELLHOP:ReadBTY&#x27;, &#x27;Insufficient memory for bathymetry data: reduce # bty points&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">174</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">175</div>
            <div class="execution-count">4</div>
            <div class="source-code">       WRITE( PRTFile, * )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">176</div>
            <div class="execution-count">4</div>
            <div class="source-code">       BathyTypeB: SELECT CASE ( btyType( 2 : 2 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">177</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;S&#x27;, &#x27;&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">178</div>
            <div class="execution-count">4</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Short format (bathymetry only)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">179</div>
            <div class="execution-count">4*</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27; Range (km)  Depth (m)&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">180</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;L&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">181</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, * ) &#x27;Long format (bathymetry and geoacoustics)&#x27;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">182</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          WRITE( PRTFile, &quot;( &#x27; Range (km)  Depth (m)  alphaR (m/s)  betaR  rho (g/cm^3)  alphaI     betaI&#x27;, / )&quot; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">183</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">184</div>
            <div class="execution-count">4*</div>
            <div class="source-code">          CALL ERROUT( &#x27;ReadBTY&#x27;, &#x27;Unknown option for selecting bathymetry interpolation&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">185</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT BathyTypeB</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">186</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">187</div>
            <div class="execution-count">44*</div>
            <div class="source-code">       btyPt: DO ii = 2, NbtyPts - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">188</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">189</div>
            <div class="execution-count">40</div>
            <div class="source-code">          SELECT CASE ( btyType( 2 : 2 ) )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">190</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;S&#x27;, &#x27;&#x27; )   ! short format</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">191</div>
            <div class="execution-count">120*</div>
            <div class="source-code">             READ(  BTYFile, * ) Bot( ii )%x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">192</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! LP: This condition was previously ii == NbtyPts,</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">193</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! which will never be satisfied due to the loop bounds</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">194</div>
            <div class="execution-count">70*</div>
            <div class="source-code">             IF ( ii &lt; Number_to_Echo .OR. ii == NbtyPts - 1 ) THEN   ! echo some values</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">195</div>
            <div class="execution-count">90*</div>
            <div class="source-code">                WRITE( PRTFile, FMT = &quot;(2G11.3)&quot; ) Bot( ii )%x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">196</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">197</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE ( &#x27;L&#x27; )       ! long format</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">198</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             READ(  BTYFile, * )                   Bot( ii )%x, Bot( ii )%HS%alphaR, Bot( ii )%HS%betaR, Bot( ii )%HS%rho, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">199</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                                                                Bot( ii )%HS%alphaI, Bot( ii )%HS%betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">200</div>
            <div class="execution-count">-</div>
            <div class="source-code">             ! LP: Same change as above</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">201</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             IF ( ii &lt; Number_to_Echo .OR. ii == NbtyPts - 1 ) THEN   ! echo some values</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">202</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                WRITE( PRTFile, FMT=&quot;( F10.2, F10.2, 3X, 2F10.2, 3X, F6.2, 3X, 2F10.4 )&quot; ) &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">203</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                                                   Bot( ii )%x, Bot( ii )%HS%alphaR, Bot( ii )%HS%betaR, Bot( ii )%HS%rho, &amp;</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">204</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                                                                Bot( ii )%HS%alphaI, Bot( ii )%HS%betaI</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">205</div>
            <div class="execution-count">-</div>
            <div class="source-code">             END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">206</div>
            <div class="execution-count">-</div>
            <div class="source-code">          CASE DEFAULT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">207</div>
            <div class="execution-count">40*</div>
            <div class="source-code">             CALL ERROUT( &#x27;ReadBTY&#x27;, &#x27;Unknown option for selecting bathymetry option&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">208</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">209</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">210</div>
            <div class="execution-count">44*</div>
            <div class="source-code">          IF ( Bot( ii )%x( 2 ) &gt; DepthB ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">211</div>
            <div class="execution-count">#####</div>
            <div class="source-code">             CALL ERROUT( &#x27;BELLHOP:ReadBTY&#x27;, &#x27;Bathymetry drops below lowest point in the sound speed profile&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">212</div>
            <div class="execution-count">-</div>
            <div class="source-code">          END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">213</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">214</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO btypt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">215</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">216</div>
            <div class="execution-count">4</div>
            <div class="source-code">       CLOSE( BTYFile )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">217</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">218</div>
            <div class="execution-count">52*</div>
            <div class="source-code">       Bot( : )%x( 1 ) = 1000.0 * Bot( : )%x( 1 )   ! Convert ranges in km to m</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">219</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">220</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE DEFAULT   ! no bathymetry given, use SSP depth for flat bottom</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">221</div>
            <div class="execution-count">24*</div>
            <div class="source-code">       ALLOCATE( Bot( 2 ), Stat = IAllocStat )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">222</div>
            <div class="execution-count">24*</div>
            <div class="source-code">       IF ( IAllocStat /= 0 ) CALL ERROUT( &#x27;BELLHOP&#x27;, &#x27;Insufficient memory for bathymetry data&#x27;  )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">223</div>
            <div class="execution-count">72*</div>
            <div class="source-code">       Bot( 1 )%x = [ -sqrt( huge( Bot( 1 )%x( 1 ) ) ) / 1.0d5, DepthB ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">224</div>
            <div class="execution-count">100*</div>
            <div class="source-code">       Bot( 2 )%x = [  sqrt( huge( Bot( 1 )%x( 1 ) ) ) / 1.0d5, DepthB ]</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">225</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">226</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">227</div>
            <div class="execution-count">28</div>
            <div class="source-code">    CALL ComputeBdryTangentNormal( Bot, &#x27;Bot&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">228</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">229</div>
            <div class="execution-count">124*</div>
            <div class="source-code">    IF ( .NOT. monotonic( Bot%x( 1 ), NBtyPts ) ) THEN</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">230</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ERROUT( &#x27;BELLHOP:ReadBTY&#x27;, &#x27;Bathymetry ranges are not monotonically increasing&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">231</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">232</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">233</div>
            <div class="execution-count">28</div>
            <div class="source-code">  END SUBROUTINE ReadBTY</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">234</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">235</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">236</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">237</div>
            <div class="execution-count">56*</div>
            <div class="source-code">  SUBROUTINE ComputeBdryTangentNormal( Bdry, BotTop )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">238</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">239</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Does some pre-processing on the boundary points to pre-compute segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">240</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! lengths  (%Len),</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">241</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! tangents (%t, %nodet),</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">242</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! normals  (%n, %noden), and</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">243</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! curvatures (%kappa)</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">244</div>
            <div class="execution-count">-</div>
            <div class="source-code">    !</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">245</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! The boundary is also extended with a constant depth to infinity to cover cases where the ray</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">246</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! exits the domain defined by the user</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">247</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">248</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, SAVE                    :: NPts = 0</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">249</div>
            <div class="execution-count">56</div>
            <div class="source-code">    REAL      (KIND=8), ALLOCATABLE  :: phi( : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">250</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL      (KIND=8)               :: sss</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">251</div>
            <div class="execution-count">-</div>
            <div class="source-code">    TYPE(BdryPt), INTENT( INOUT )    :: Bdry( : )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">252</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=3),  INTENT( IN ) :: BotTop           ! Flag indicating bottom or top reflection</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">253</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CHARACTER (LEN=2), SAVE          :: CurvilinearFlag = &#x27;-&#x27;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">254</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">255</div>
            <div class="execution-count">28</div>
            <div class="source-code">    SELECT CASE ( BotTop )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">256</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;Bot&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">257</div>
            <div class="execution-count">28</div>
            <div class="source-code">       NPts = NbtyPts</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">258</div>
            <div class="execution-count">28</div>
            <div class="source-code">       CurvilinearFlag = btyType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">259</div>
            <div class="execution-count">-</div>
            <div class="source-code">    CASE ( &#x27;Top&#x27; )</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">260</div>
            <div class="execution-count">28</div>
            <div class="source-code">       NPts = NatiPts</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">261</div>
            <div class="execution-count">56</div>
            <div class="source-code">       CurvilinearFlag = atiType</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">262</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">263</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">264</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! extend the bathymetry to +/- infinity in a piecewise constant fashion</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">265</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">266</div>
            <div class="execution-count">56*</div>
            <div class="source-code">    Bdry( 1    )%x( 1 ) = -sqrt( huge( Bdry( 1 )%x( 1 ) ) ) / 1.0d5</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">267</div>
            <div class="execution-count">56*</div>
            <div class="source-code">    Bdry( 1    )%x( 2 ) = Bdry( 2        )%x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">268</div>
            <div class="execution-count">56*</div>
            <div class="source-code">    Bdry( 1    )%HS     = Bdry( 2        )%HS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">269</div>
            <div class="execution-count">56*</div>
            <div class="source-code">    Bdry( NPts )%x( 1 ) = +sqrt( huge( Bdry( 1 )%x( 1 ) ) ) / 1.0d5</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">270</div>
            <div class="execution-count">56*</div>
            <div class="source-code">    Bdry( NPts )%x( 2 ) = Bdry( NPts - 1 )%x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">271</div>
            <div class="execution-count">56*</div>
            <div class="source-code">    Bdry( NPts )%HS     = Bdry( NPts - 1 )%HS</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">272</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">273</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! compute tangent and outward-pointing normal to each bottom segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">274</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! tBdry( 1, : ) = xBdry( 1, 2:NPts ) - xBdry( 1, 1:NPts - 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">275</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! tBdry( 2, : ) = xBdry( 2, 2:NPts ) - xBdry( 2, 1:NPts - 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">276</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! above caused compiler problems</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">277</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">278</div>
            <div class="execution-count">152*</div>
            <div class="source-code">    BoundaryPt: DO ii = 1, NPts - 1</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">279</div>
            <div class="execution-count">288*</div>
            <div class="source-code">       Bdry( ii )%t   = Bdry( ii + 1 )%x      - Bdry( ii )%x</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">280</div>
            <div class="execution-count">96*</div>
            <div class="source-code">       Bdry( ii )%Dx  = Bdry( ii )%t( 2 ) / Bdry( ii )%t( 1 )   ! first derivative</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">281</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! write( *, * ) &#x27;Dx, t&#x27;, Bdry( ii )%Dx, Bdry( ii )%x, 1 / ( Bdry( ii )%x( 2 ) / 500 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">282</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">283</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! normalize the tangent vector</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">284</div>
            <div class="execution-count">288*</div>
            <div class="source-code">       Bdry( ii )%Len = NORM2( Bdry( ii )%t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">285</div>
            <div class="execution-count">288*</div>
            <div class="source-code">       Bdry( ii )%t   = Bdry( ii )%t / Bdry( ii )%Len</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">286</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">287</div>
            <div class="execution-count">56</div>
            <div class="source-code">       SELECT CASE ( BotTop )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">288</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;Bot&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">289</div>
            <div class="execution-count">68*</div>
            <div class="source-code">          Bdry( ii )%n( 1 ) = -Bdry( ii )%t( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">290</div>
            <div class="execution-count">68*</div>
            <div class="source-code">          Bdry( ii )%n( 2 ) = +Bdry( ii )%t( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">291</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;Top&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">292</div>
            <div class="execution-count">28*</div>
            <div class="source-code">          Bdry( ii )%n( 1 ) = +Bdry( ii )%t( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">293</div>
            <div class="execution-count">124*</div>
            <div class="source-code">          Bdry( ii )%n( 2 ) = -Bdry( ii )%t( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">294</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">295</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">296</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END DO BoundaryPt</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">297</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">298</div>
            <div class="execution-count">56</div>
            <div class="source-code">    IF ( CurvilinearFlag( 1 : 1 ) == &#x27;C&#x27; ) THEN ! curvilinear option: compute tangent and normal at node by averaging normals on adjacent segments</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">299</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! averaging two centered differences is equivalent to forming a single centered difference of two steps ...</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">300</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO ii = 2, NPts - 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">301</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          sss = Bdry( ii - 1 )%Len / ( Bdry( ii - 1 )%Len + Bdry( ii )%Len )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">302</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          sss = 0.5 ! LP: BUG? Line above is overwritten.</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">303</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( ii )%Nodet = ( 1.0 - sss ) * Bdry( ii - 1 )%t + sss * Bdry( ii )%t</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">304</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">305</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">306</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Bdry( 1    )%Nodet = [ 1.0, 0.0 ]   ! tangent left-end  node</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">307</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       Bdry( NPts )%Nodet = [ 1.0, 0.0 ]   ! tangent right-end node</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">308</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">309</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       SELECT CASE ( BotTop )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">310</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;Bot&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">311</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( : )%Noden( 1 ) = -Bdry( : )%Nodet( 2 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">312</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( : )%Noden( 2 ) = +Bdry( : )%Nodet( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">313</div>
            <div class="execution-count">-</div>
            <div class="source-code">       CASE ( &#x27;Top&#x27; )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">314</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( : )%Noden( 1 ) = +Bdry( : )%Nodet( 2 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">315</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( : )%Noden( 2 ) = -Bdry( : )%Nodet( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">316</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END SELECT</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">317</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">318</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! compute curvature in each segment</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">319</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! LP: This allocation is not necessary, could just have two variables for</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">320</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! current and next phi. Operating on the whole array can trigger compiler</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">321</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! SIMD parallelism (AVX-512 etc.), but this is unlikely to happen for</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">322</div>
            <div class="execution-count">-</div>
            <div class="source-code">       ! atan2, and this is in one-time setup code anyway.</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">323</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       ALLOCATE( phi( NPts ), Stat = IAllocStat )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">324</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       phi = atan2( Bdry( : )%Nodet( 2 ), Bdry( : )%Nodet( 1 ) )   ! this is the angle at each node</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">325</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">326</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DO ii = 1, NPts - 1</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">327</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( ii )%kappa = ( phi( ii + 1 ) - phi( ii ) ) / Bdry( ii )%Len ! this is curvature = dphi/ds</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">328</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( ii )%Dxx   = ( Bdry( ii + 1 )%Dx     - Bdry( ii )%Dx     ) / &amp;   ! second derivative</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">329</div>
            <div class="execution-count">#####</div>
            <div class="source-code">                             ( Bdry( ii + 1 )%x( 1 ) - Bdry( ii )%x( 1 ) )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">330</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( ii )%Dss   = Bdry( ii )%Dxx * Bdry( ii )%t( 1 ) ** 3   ! derivative in direction of tangent</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">331</div>
            <div class="execution-count">-</div>
            <div class="source-code">          !write( *, * ) &#x27;kappa, Dss, Dxx&#x27;, Bdry( ii )%kappa, Bdry( ii )%Dss, Bdry( ii )%Dxx, &amp;</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">332</div>
            <div class="execution-count">-</div>
            <div class="source-code">               ! 1 / ( ( 8 / 1000 ** 2 ) * ABS( Bdry( ii )%x( 2 ) ) ** 3 ), Bdry( ii )%x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">333</div>
            <div class="execution-count">-</div>
            <div class="source-code">               !  -1 / ( 4 * ( Bdry( ii )%x( 2 ) ) ** 3 / 1000000 ), Bdry( ii )%x( 2 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">334</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">335</div>
            <div class="execution-count">#####</div>
            <div class="source-code">          Bdry( ii )%kappa = Bdry( ii )%Dss   !over-ride kappa !!!!!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">336</div>
            <div class="execution-count">-</div>
            <div class="source-code">       END DO</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">337</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">338</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       DEALLOCATE( phi ) ! LP: was missing deallocation</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">339</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">340</div>
            <div class="execution-count">208*</div>
            <div class="source-code">       Bdry%kappa = 0</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">341</div>
            <div class="execution-count">-</div>
            <div class="source-code">    END IF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">342</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">343</div>
            <div class="execution-count">56*</div>
            <div class="source-code">  END SUBROUTINE ComputeBdryTangentNormal</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">344</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">345</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">346</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">347</div>
            <div class="execution-count">116030</div>
            <div class="source-code">  SUBROUTINE GetTopSeg( r, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">348</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">349</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Get the Top segment info (index and range interval) for range, r</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">350</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! LP: t: range component of ray tangent. Endpoints of segments are handled</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">351</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! so that if the ray moves slightly along its current direction, it will</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">352</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! remain in the same segment.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">353</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">354</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, PARAMETER :: PRTFile = 6</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">355</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER :: IsegTopT( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">356</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( IN ) :: r, t</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">357</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">358</div>
            <div class="execution-count">116030</div>
            <div class="source-code">    IF ( t &gt; 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">359</div>
            <div class="execution-count">580150*</div>
            <div class="source-code">       IsegTopT = MAXLOC( Top( : )%x( 1 ), Top( : )%x( 1 ) &lt;= r )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">360</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">361</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       IsegTopT = MAXLOC( Top( : )%x( 1 ), Top( : )%x( 1 ) &lt;  r )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">362</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">363</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">364</div>
            <div class="execution-count">116030</div>
            <div class="source-code">    IF ( IsegTopT( 1 ) &gt; 0 .AND. IsegTopT( 1 ) &lt; NatiPts ) THEN  ! IsegTop MUST LIE IN [ 1, NatiPts-1 ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">365</div>
            <div class="execution-count">116030</div>
            <div class="source-code">       IsegTop = IsegTopT( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">366</div>
            <div class="execution-count">348090*</div>
            <div class="source-code">       rTopSeg = [ Top( IsegTop )%x( 1 ), Top( IsegTop + 1 )%x( 1 ) ]   ! segment limits in range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">367</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">368</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;r = &#x27;, r</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">369</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;rLeft  = &#x27;, Top( 1       )%x( 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">370</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;rRight = &#x27;, Top( NatiPts )%x( 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">371</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ERROUT( &#x27;GetTopSeg&#x27;, &#x27;Top altimetry undefined above the ray&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">372</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">373</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">374</div>
            <div class="execution-count">116030</div>
            <div class="source-code">  END SUBROUTINE GetTopSeg</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">375</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">376</div>
            <div class="execution-count">-</div>
            <div class="source-code">  ! **********************************************************************!</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">377</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">378</div>
            <div class="execution-count">140383</div>
            <div class="source-code">  SUBROUTINE GetBotSeg( r, t )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">379</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">380</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! Get the Bottom segment info (index and range interval) for range, r</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">381</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! LP: t: range component of ray tangent. Endpoints of segments are handled</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">382</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! so that if the ray moves slightly along its current direction, it will</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">383</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ! remain in the same segment.</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">384</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">385</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER, PARAMETER :: PRTFile = 6</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">386</div>
            <div class="execution-count">-</div>
            <div class="source-code">    INTEGER :: IsegBotT( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">387</div>
            <div class="execution-count">-</div>
            <div class="source-code">    REAL (KIND=8), INTENT( IN ) :: r, t</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">388</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">389</div>
            <div class="execution-count">140383</div>
            <div class="source-code">    IF ( t &gt; 0.0 ) THEN</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">390</div>
            <div class="execution-count">1404445*</div>
            <div class="source-code">       IsegBotT = MAXLOC( Bot( : )%x( 1 ), Bot( : )%x( 1 ) &lt;= r )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">391</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">392</div>
            <div class="execution-count">382482*</div>
            <div class="source-code">       IsegBotT = MAXLOC( Bot( : )%x( 1 ), Bot( : )%x( 1 ) &lt;  r )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">393</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">394</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">395</div>
            <div class="execution-count">140383</div>
            <div class="source-code">    IF ( IsegBotT( 1 ) &gt; 0 .AND. IsegBotT( 1 ) &lt; NbtyPts ) THEN  ! IsegBot MUST LIE IN [ 1, NbtyPts-1 ]</div>
        </div>
        <div class="code-line executed">
            <div class="line-number">396</div>
            <div class="execution-count">140383</div>
            <div class="source-code">       IsegBot = IsegBotT( 1 )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">397</div>
            <div class="execution-count">421149*</div>
            <div class="source-code">       rBotSeg = [ Bot( IsegBot )%x( 1 ), Bot( IsegBot + 1 )%x( 1 ) ]   ! segment limits in range</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">398</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ELSE</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">399</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;r = &#x27;, r</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">400</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;rLeft  = &#x27;, Bot( 1       )%x( 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">401</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       WRITE( PRTFile, * ) &#x27;rRight = &#x27;, Bot( NbtyPts )%x( 1 )</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">402</div>
            <div class="execution-count">#####</div>
            <div class="source-code">       CALL ERROUT( &#x27;GetBotSeg&#x27;, &#x27;Bottom bathymetry undefined below the source&#x27; )</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">403</div>
            <div class="execution-count">-</div>
            <div class="source-code">    ENDIF</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">404</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line executed">
            <div class="line-number">405</div>
            <div class="execution-count">140383</div>
            <div class="source-code">  END SUBROUTINE GetBotSeg</div>
        </div>
        <div class="code-line non-executable">
            <div class="line-number">406</div>
            <div class="execution-count">-</div>
            <div class="source-code"></div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">407</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE bdrymod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">407</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE bdrymod</div>
        </div>
        <div class="code-line not-executed">
            <div class="line-number">407</div>
            <div class="execution-count">#####</div>
            <div class="source-code">END MODULE bdrymod</div>
        </div>
    </div>

    <div class="footer">
        <p><strong>Legend:</strong></p>
        <ul>
            <li><span style="background-color: #d4edda; padding: 2px 4px;">Green</span> - Executed lines</li>
            <li><span style="background-color: #f8d7da; padding: 2px 4px;">Red</span> - Not executed lines</li>
            <li><span style="background-color: #f8f9fa; padding: 2px 4px;">Gray</span> - Non-executable lines (comments, declarations)</li>
        </ul>
        <p><strong>Execution Count:</strong> Number of times each line was executed. ##### indicates never executed, - indicates non-executable.</p>
    </div>
</body>
</html>